\section{Coupler}

Optical splitters and couplers are essential for many sophisticated experiments and devices ranging from classical interferometers to experimental realization of quantum NOT gates~\cite{Adami1998}.
An optical coupler superimposes (mixes) two optical fields, an optical splitter divides an input's power among two outputs.
From a physical perspective, the distinction between splitters and couplers is somewhat artificial, and a description using two inputs and two outputs turns out to be strictly necessary.

The present section starts with a discussion of the classical free-ray beam splitter. Employing energy conservation between the complex in- and output field modes leads to a unitary transformation that can be easily extended to the quantum regime as done in the standard quantum optics literature~\cite{Leonhardt2010,Gerry2005,Loudon2000}.
A different approach closely related to network analysis in electrical engineering defines the optical coupler as a linear passive optical four-port and requires no further assumptions.
The measurement of the scattering parameters can fully characterize the linear passive optical four-port.
Finally, using mode-coupling theory~\cite[p.~359]{Luks2009}, we present a more natural quantum model specific to the waveguide coupler.
We close the section with general input-output relations for coherent states to discuss the limiting cases, e.g., the optical splitter.

\subsection{Classical free-ray beam splitters}

The most commonly employed (free-ray) designs of the beam splitter are the cubic, plate, and pellicle beam splitters depicted in \Cref{fig:beam_splitter_types}.
The cubic beam splitter is made of two triangular prisms.
The interface between the two prisms is finished with a dielectric coating.
The outward-facing surface of the prisms is grafted with an \gls{ar} coating.
Compared to the plate and pellicle beam splitter, the cubic beam splitter has the highest loss and aberrations.
Nonetheless, the cubic beam splitter is a popular choice because of its simple integration into an optical setup.
The pellicle beam splitter consists of a few micrometer thin membrane, optionally with a one-sided coating.
The small thickness of the membrane makes the pellicle beam splitter the most performant in terms of absorption and aberrations among the three designs.
Furthermore, the pellicle embodiment of the beam splitter supports a broad wavelength range.
The drawback of using a pellicle beam splitter is that they are highly susceptible to acoustic noise and require a precise angle to the incident beam.
The plate beam splitter is like a thick pellicle beam splitter made of glass.
Compared to the cubic and pellicle beam splitter's performance, the plate beam splitter is in-between concerning absorption, aberrations, and wavelength range.
\begin{figure}[htb]
    \centering
    \includestandalone{figures/tikz/beam-splitter-types}
    \caption{Cubic (a), plate (b), and pellicle (c) beam splitter.}\label{fig:beam_splitter_types}
\end{figure}
Given two input beams, represented by the electrical field components $E_1(t)$ and $E_2(t)$, a beam splitter gives rise to two output beams, represented by the electrical field components $E_1^\prime(t)$ and $E_2^\prime(t)$.
\Cref{fig:beam_splitter_cube_plate} illustrates how the input and output fields emerge in the cubic and plate beam splitter.
The two input fields $E_1(t),E_2(t)$ are incident to the cubic and plate beam splitter's left and top, while the two output electric fields $E_1^\prime(t),E_2^\prime(t)$ exit the beam splitter at the right and bottom.
\begin{figure}[htb]
    \centering
    \includestandalone{figures/tikz/beam-splitter-cubic-plate}
    \caption{Cubic (left) and plate beam splitter (right) with two input beams represented by the electrical field components $E_1(t),E_2(t)$ and two output beam represented by the electrical field components $E_1^\prime(t),E_2^\prime(t)$.}\label{fig:beam_splitter_cube_plate}
\end{figure}

Inside the beam splitter the electric field $\vb{E}(t,\vb{x})$ satisfies the inhomogeneous wave equation
\begin{equation}
	\laplacian\vb{E}(t,\vb{x})
	-
	\mu\pdv[2]{t}\vb{E}(t,\vb{x})
	=
	\mu\pdv[2]{t}\vb{P}(t,\vb{x})
\end{equation}
where $\mu$ is the magnetic permeability and $\vb{P}(t,\vb{x})$ is the macroscopic polarization~\cite[p.~86]{Murti2014}.
In frequency space, the components of the macroscopic polarization are~\cite[p.~1070]{Mandel1995}
\begin{equation}
	P_i(\omega)
	=
	\chi^{(1)}_{ij}(\omega)E^j(\omega)
	+
	\chi^{(2)}_{ijk}(\omega,\omega^\prime)E^j(\omega)E^k(\omega^\prime)
	+
	\dots
\end{equation}
where $\chi^{(n)}$ denotes the $n$th-order of the electric susceptibility tensor.
For a useful beam splitter, we want the electric susceptibility to be linear in frequency space suggesting the Fourier amplitudes of the in- and output fields to relate via
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(\omega)
        \\
        \mathcal{E}_2^\prime(\omega)
    \end{pmatrix}
    =
    \begin{pmatrix}
        t(\omega) & r^\prime(\omega)
        \\
        r(\omega) & t^\prime(\omega)
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(\omega)
        \\
        \mathcal{E}_2(\omega)
    \end{pmatrix}
    \label{eq:beam_splitter_transform}
\end{equation}
wherein $r(\omega),r^\prime(\omega)$ and $t(\omega),t^\prime(\omega)$ are complex coefficients.
Setting either one of the input Fourier amplitudes, $\mathcal{E}_1(\omega)$ or $\mathcal{E}_2(\omega)$, to zero and reviewing \Cref{fig:beam_splitter_cube_plate}, suggests $r(\omega),r^\prime(\omega)$ and $t(\omega),t^\prime(\omega)$ to quantify the reflection respective transmission properties of the beam splitter.
The absolute value of the transmission $\abs{t(\omega)},\abs{t^\prime(\omega)}$ and reflection coefficients $\abs{r(\omega)},\abs{r^\prime(\omega)}$ determine the splitting ratio of the input power among the outputs.
The complex phase factor of the reflection and transmission coefficients characterize the phase shifts with which the input fields contribute to the output fields.

The beam splitter including the in- and output fields constitute an isolated system.
Ignoring thermal energy exchange between the electric fields and the beam splitter medium, the sum of the field energies before and after the interaction need to be conserved, i.e.,
\begin{equation}
    \abs{\mathcal{E}_1^\prime(\omega)}^2
    +
    \abs{\mathcal{E}_2^\prime(\omega)}^2
    =
    \abs{\mathcal{E}_1(\omega)}^2
    +
    \abs{\mathcal{E}_2(\omega)}^2
    \label{eq:beam_splitter_energy_conservation}
    .
\end{equation}
Inserting \cref{eq:beam_splitter_transform} into \cref{eq:beam_splitter_energy_conservation} and setting the one of the input fields to zero, constraints the coefficients by
\begin{align}
    \abs{r(\omega)}^2+\abs{t(\omega)}^2
    =
    1,
    &&
    \abs{r^\prime(\omega)}^2+\abs{t^\prime(\omega)}^2
    =
    1
    \label{eq:beam_splitter_coefficients_constraint}
    .
\end{align}
Theorists often claim the transformation in \cref{eq:beam_splitter_transform} to be symmetric (or reciprocal) due to Maxwell's equations~\cite[p.~129]{Haroche2006}.
However, according Ref.~\cite{Potton2004} only optical system with a single dielectric layer are reciprocal but most physical beam splitters comprise multiple dielectric layers.\footnote{For example, cubic beam splitters have a coating followed by optical cement between the prisms breaking reciprocal symmetry of the system.}

Using classical wave optics and perfect knowledge of the dimensions and material properties, it is possible to derive exact expressions of the complex reflection $r(\omega),r^\prime(\omega)$ and transmission coefficients $t(\omega),t^\prime(\omega)$.
For example, HÃ©nault~\cite{Henault2015} derived an exact expression for the reflected and transmitted amplitudes of a plate beam splitter with one input and a single dielectric layer.
Likewise, Hamilton~\cite{Hamilton2000} discusses the cubic beam splitter with two inputs and different coatings.
In general, the complex reflection and transmission coefficients need to account for multiple reflections at different dielectric layers inside the beam splitter.

\FloatBarrier
\subsection{Unitary beam splitter transform}

Assuming an ideal beam splitter, i.e., a linear lossless optical device with two in- and two output fields, we notice that energy conservation \cref{eq:beam_splitter_energy_conservation} corresponds to an inner product which is automatically preserved if \cref{eq:beam_splitter_transform} is unitary.
A particular useful parametrization of the unitary transformation is introduced by Leonhardt~\cite[p.~92]{Leonhardt2010}
\begin{equation}
	U(\omega)
	=
    e^{i\Lambda(\omega)}
    \begin{pmatrix}
        e^{+i\Phi(\omega)} & 0
        \\
        0 & e^{-i\Phi(\omega)}
    \end{pmatrix}
    \begin{pmatrix}
        \cos\Theta(\omega) & \sin\Theta(\omega)
        \\
        -\sin\Theta(\omega) & \cos\Theta(\omega)
    \end{pmatrix}
    \begin{pmatrix}
        e^{+i\Psi(\omega)} & 0
        \\
        0 & e^{-i\Psi(\omega)}
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform}
\end{equation}
with frequency-dependent angles $\Lambda(\omega),\Theta(\omega),\Psi(\omega),\Phi(\omega)\in\mathbb{R}$.
An alternative parametrization involving Pauli matrices is discussed, for instance, in Ref.~\cite{Zeilinger1981}.
The parametrization of \cref{eq:beam_splitter_unitary_transform} allows for a physical interpretation without assumptions of a macroscopic model.
More precisely, the matrix product in \cref{eq:beam_splitter_unitary_transform} reads as the composition of a phase transform of $\pm\Psi(\omega)$ applied to the input fields, a mixing of the input fields with angle $\Theta(\omega)$, and a phase transform of $\pm\Phi(\omega)$ applied to the mixed fields, in addition, the output fields pick up a global phase $\Lambda(\omega)$ from the optical path length common to the beams.
If the beam splitter is part of a subsystem, then the global phase $\Lambda(\omega)$ becomes local, thereby measurable, and cannot be neglected.

Carrying out the matrix multiplication in \cref{eq:beam_splitter_unitary_transform}, we find
\begin{equation}
	U(\omega)
	=
    e^{i\Lambda(\omega)}
    \begin{pmatrix}
        e^{+i\psi(\omega)/2}\cos\Theta(\omega) & e^{i\phi(\omega)/2}\sin\Theta(\omega)
        \\
        ie^{-i\phi(\omega)/2}\sin\Theta(\omega) & e^{-i\psi(\omega)/2}\cos\Theta(\omega)
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_expanded}
\end{equation}
where we introduced $\phi(\omega)=(\Phi(\omega)+\Psi(\omega))/2,\psi(\omega)=(\Phi(\omega)-\Psi(\omega))/2$.
For $\Theta(\omega)=0$ and $\Theta(\omega)=\pi/2$ there is no mixing, yet, there is a subtle difference between these cases.
In the case of $\Theta(\omega)=0$, the output fields relate to the input fields via
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(\omega)
        \\
        \mathcal{E}_2^\prime(\omega)
    \end{pmatrix}
    =
    e^{i\Lambda(\omega)}
    \begin{pmatrix}
        \mathcal{E}_1(\omega)e^{+i\psi(\omega)/2}
        \\
        \mathcal{E}_2(\omega)e^{-i\psi(\omega)/2}
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_transmission},
\end{equation}
in other words, an additional phase difference of $\psi(\omega)$ is added between the output fields.
In the case of $\Theta(\omega)=\pi/2$, \cref{eq:beam_splitter_unitary_transform_expanded} becomes
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(\omega)
        \\
        \mathcal{E}_2^\prime(\omega)
	\end{pmatrix}
    =
    e^{i\Lambda(\omega)}
    \begin{pmatrix}
        \mathcal{E}_2(\omega)e^{+i\phi(\omega)/2}
        \\
        \mathcal{E}_1(\omega)e^{-i\phi(\omega)/2+i\pi}
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_reflection},
\end{equation}
and a phase difference of $\pi(\omega)-\phi(\omega)$ is added between the output fields.
The difference between these two phase shifts between the output fields yields $\phi(\omega)+\psi(\omega)=\pi$.
If we identify $\Theta(\omega)=0$ with the transmitted and $\Theta(\omega)=\pi/2$ with the reflected field\footnote{Only the physical models have a notion of reflectance and transmittance. For the unitary transformation there is no fundamental difference between $\Theta(\omega)=0,\pi/2$ as the $\pi$ phase can be moved around by reparamtrization.}, we recover the statement~\cite{Zeilinger1981} that the phase shift between the transmitted and reflected fields of an ideal beam splitter adds up to $\pi$.\footnote{The statement should not be confused with the statement that the phase difference between the output fields are phase-shifted by $\pi$.}

Evidently, the phases $\psi(\omega),\phi(\omega)$ are a source of confusion and require a thorough examination.
For simplicity, we assume a balanced lossless beam splitter which distributes the input power equally among the outputs.
The corresponding transformation is obtained by setting $\Theta(\omega)=\pi/4$ in \cref{eq:beam_splitter_unitary_transform}
\begin{equation}
	U_{50:50}(\omega)
	=
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        e^{i\phi(\omega)} & e^{i\psi(\omega)}
        \\
        -e^{-i\psi(\omega)} & e^{-i\phi(\omega)}
    \end{pmatrix}
    e^{i\Lambda(\omega)}
    \label{eq:beam_splitter_unitary_transform_balanced}
    .
\end{equation}
\Cref{eq:beam_splitter_unitary_transform_balanced} cannot be simplified without further assumptions.
In principle, the dimensions, materials and coatings of a physical beam splitter can be tailored for specific $\psi(\omega),\phi(\omega),\Lambda(\omega)$.
\begin{align}
	U_{50:50}^\text{qo}
	=
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        1 & i\\
        i & 1
    \end{pmatrix}
    &&
	U_{50:50}^\text{qc}
	=
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        1 & -1\\
        1 & 1
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_balanced_qoqc},
\end{align}
We frequently find the claim in the quantum optics literature, for instance, Ref.~\cite[p.~138]{Gerry2005} that $U_{50:50}^\text{qo}$ describes an ideal balanced beam splitter.
In contrast, the quantum communication literature, for example, Ref.~\cite{Shapiro2009}, postulates $U_{50:50}^\text{qc}$ as the transformation of an ideal balanced beam splitter.\footnote{$U_{50:50}^\text{qc}$ let us write the compact expression $\mathcal{E}_\pm(\omega)=\left(\mathcal{E}_1(\omega)\pm\mathcal{E}_2(\omega)\right)/\sqrt{2}$ for the output fields.} 
While $U_{50:50}^\text{qo}$ corresponds to $\Lambda(\omega)=0,\psi(\omega)=0,\phi(\omega)=\pi/2$ in \cref{eq:beam_splitter_unitary_transform_balanced}, and $U_{50:50}^\text{qc}$ can be obtained with $\Lambda(\omega)=0,\phi(\omega)=0,\psi(\omega)=\pi$, we rarely find a justification to remove three physical \gls{dof}.
If we assume an ideal beam splitter's global phase to be truly global and the other phases to be symmetric with respect to the input fields, it is possible to derive $U_{50:50}^\text{qo}$ from \cref{eq:beam_splitter_unitary_transform_balanced}.
The first assumption lets us remove two \gls{dof}:
First, $\Lambda(\omega)$ is a global phase that cannot be measured, and we are free to choose $\Lambda(\omega)$ as convenient.
Second, we are allowed to choose a common phase origin.
Let us explicitly write $\mathcal{E}_1(\omega)e^{i\delta_1}$ and $\mathcal{E}_2(\omega)e^{i\delta_2}$.
By adjusting the global phase $\Lambda(\omega)$ accordingly, this is equivalent to $\mathcal{E}_1(\omega)e^{i\Delta\delta}$ and $\mathcal{E}_2(\omega)$ wherein $\Delta\delta=\delta_1-\delta_2$, and we can rewrite \cref{eq:beam_splitter_unitary_transform_balanced} together with the field amplitudes as
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(\omega)
        \\
        \mathcal{E}_2^\prime(\omega)
    \end{pmatrix}
    =
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        e^{i(\phi(\omega)/2+\Delta\delta)} & e^{i\psi(\omega)/2}
        \\
        -e^{-i(\psi(\omega)/2-\Delta\delta)} & e^{-i\phi(\omega)/2}
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(\omega)
        \\
        \mathcal{E}_2(\omega)
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_balanced_phase_origin}.
\end{equation}
By the second assumption, $e^{i\psi(\omega)/2}=-e^{i(\psi(\omega)/2-\Delta\delta)}$, or equivalently, $\psi(\omega)=\pi/2+\Delta\delta/2$ and \cref{eq:beam_splitter_unitary_transform_balanced_phase_origin} becomes
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(\omega)
        \\
        \mathcal{E}_2^\prime(\omega)
    \end{pmatrix}
    =
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        e^{i(\phi(\omega)+\Delta\delta/2)} & i
        \\
        i & e^{-i(\phi(\omega)+\Delta\delta/2)}
    \end{pmatrix}
    e^{i\Delta\delta/2}
    \begin{pmatrix}
        \mathcal{E}_1(\omega)
        \\
        \mathcal{E}_2(\omega)
    \end{pmatrix}
    .
\end{equation}
Removing the global phase and choosing the phase reference such that $\phi(\omega)+\Delta\delta=0$ finally yields $U_{50:50}^\text{qo}$.
It should be clear from our initial discussion that the assumption of a symmetric beam splitter is not justified in general for most practical beam splitter designs.
In particular, engineering of control loops to find operating points in modulators comprising beam splitters, for instance, in automatic bias control of \gls{mzm}, requires a throughout analysis of relevant phases in a system.
That said, as long as we are only interested in specific aspects of a system, it is perfectly fine to chose the phases such that the calculation become as simple as possible.

\FloatBarrier
\subsection{Linear passive four-port}

% TODO: cite reference where reflection and transmission properties are measured

In electrical and optical network theory, it is common practice to model devices by their number of in- and outputs while assuming linear operation of the components.
One advantage of such an approach is that one does not need to know the internals of the components at hand.
Another advantage is that the component can be fully characterized by measuring the in- and output scattering parameters.
\begin{figure}[htb]
    \centering
    \includestandalone{figures/tikz/four-port}
    \caption{Linear optical four-port with input field..}\label{fig:four_port}
\end{figure}
\Cref{fig:four_port} shows a linear optical four-port.
In contrast to our beam splitter model, does the four-port account for backscattering (or back reflection) and we discussed for the practical beam splitters that back reflection indeed occurs for the cubic beam splitter.
For fiber-optical components the scattering parameters are usually specified in the technical datasheet.
Alternatively, an optical network analyzer, see the setup in \Cref{fig:optical_network_analyzer}, is able to determine the scattering parameters.
\begin{figure}[htb]
    \centering
    \includegraphics{figures/pstricks/optical-network-analyzer}
    \caption{Experimental setup of an optical network analyzer measuring the scattering parameters of an optical four-port.}\label{fig:optical_network_analyzer}
\end{figure}
The complex scattering parameters are the elements of the scattering matrix $S(\omega)\in\mathbb{C}^{4\times4}$ which relates the in- and output field amplitudes via
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_{1}^\text{out}(\omega) \\
        \mathcal{E}_{2}^\text{out}(\omega) \\
        \mathcal{E}_{3}^\text{out}(\omega) \\
        \mathcal{E}_{4}^\text{out}(\omega)
    \end{pmatrix}
    =
    \begin{pmatrix}
    	s_{11}(\omega) & s_{12}(\omega) & s_{13}(\omega) & s_{14}(\omega) \\
    	s_{21}(\omega) & s_{22}(\omega) & s_{23}(\omega) & s_{24}(\omega) \\
    	s_{31}(\omega) & s_{32}(\omega) & s_{33}(\omega) & s_{34}(\omega) \\
    	s_{41}(\omega) & s_{42}(\omega) & s_{43}(\omega) & s_{44}(\omega)
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_{1}^\text{in}(\omega) \\
        \mathcal{E}_{2}^\text{in}(\omega) \\
        \mathcal{E}_{3}^\text{in}(\omega) \\
        \mathcal{E}_{4}^\text{in}(\omega)
    \end{pmatrix}
\end{equation}
and accounts for reflection, transmission, cross-talk, and coupling of the ports.
For a passive four-port the energy of the output field amplitudes must be less or equal to the energy of the input field amplitudes and strictly equal for a lossless passive four-port.
Most fiber components are reciprocal~\cite{NBS1981} and the scattering matrix $S(\omega)$ is transpose symmetric.

The beam splitter transformation is the special case
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_{1}^\text{out} \\
        \mathcal{E}_{2}^\text{out} \\
        \mathcal{E}_{3}^\text{out} \\
        \mathcal{E}_{4}^\text{out}
    \end{pmatrix}
    =
    \begin{pmatrix}
    	0 & 0 & 0 & 0 \\
    	0 & 0 & 0 & 0 \\
    	s_{31}(\omega) & s_{32}(\omega) & 0 & 0 \\
    	s_{41}(\omega) & s_{42}(\omega) & 0 & 0
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_{1}^\text{in}(\omega) \\
        \mathcal{E}_{2}^\text{in}(\omega) \\
        \mathcal{E}_{3}^\text{in}(\omega) \\
        \mathcal{E}_{4}^\text{in}(\omega)
    \end{pmatrix}
\end{equation}
with the identifications $\mathcal{E}_i^\text{in}=\mathcal{E}_i,\mathcal{E}_i^\text{out}=\mathcal{E}_i^\prime$ and
\begin{equation}
    \begin{pmatrix}
    	s_{31}(\omega) & s_{32}(\omega) \\
    	s_{41}(\omega) & s_{42}(\omega)
    \end{pmatrix}
    =
    \begin{pmatrix}
    	t(\omega) & r(\omega) \\
    	r(\omega) & t(\omega)
    \end{pmatrix}
    .
\end{equation}
While accounting for back reflection of the mode coupler is almost never considered by physicists, our receiver is optimized for such low light intensities that back reflection of the strong \gls{lo} laser is observed and needs to be removed with an optical isolator. 

\FloatBarrier
\subsection{Fiber-optical coupler}

Coupled-mode theory is described in Ref.~\cite[p.~359]{Luks2009}.
\begin{figure}[htb]
	\centering
	\includestandalone{figures/tikz/fiber-coupler}
	\caption{Two-dimensional model of a fiber-optical coupler.}\label{fig:fiber_coupler}
\end{figure}

\FloatBarrier
\subsection{Quantum mode coupler}

% approaches:
% a) extend concept of unitary transform to annihilation operators
% b) use linear interaction Hamiltonian (Haroche)
% c) use mode-coupling theory

% theoretical models:
% - coupled mode theory \cite[p.~359]{Luks2009}
% - nonclassical fields in a linear coupler \cite{Lai1991}
% - generalized non-linear coupling in \cite{Abdalla2000}
% - macroscopic reflection and transmission using topological Chern-Simons term 

A quantum mode coupler superimposes two quantized plane-wave modes of the same frequency, represented by annihilation and creation operators.
The most popular approach to extend the classical optical coupler to the quantum optical regime found in the quantum optics literature proposes replacing the classical electrical Fourier amplitudes with the quantum annihilation operators of the respective field modes, see Refs.~\cite{Leonhardt2010,Fox2006,Gerry2005}.
The approach successfully recovers the classical relations due to the linear relation between the classical field amplitudes and the expectation value of the electric field operator.
Furthermore, the predictions for non-classical states, e.g., number states, match the experimental observations.
Despite the success, the popular ad-hoc approach does not integrate well into the existing framework of quantum mechanics.
An alternative approach, which we follow here and extend to a mode continuum, is presented in Ref.~\cite[p.~131]{Haroche2006} and Ref.~\cite[p.~17]{QuesadaMejia2015}, uses interaction theory to derive the unitary beam splitter transformation from an interaction Hamiltonian.

The theoretical system under consideration can be best thought as the fiber-optical coupler where we have two independent, e.g., spatially separated, propagating mode continuums.
Without interaction, the propagating mode continuums are described by the two free field Hamiltonians $\hat{H}_1,\hat{H}_2$ of the form
\begin{equation}
	\hat{H}_i
	=
	\int\frac{\dd{p}}{(2\pi)\sqrt{2p}}
	\omega(p)
	\hat{a}_i^\dagger(p)
	\hat{a}_i(p)
\end{equation}
where the mode frequency is equal to the momentum in the propagation direction $\omega(p)=p$.
With interaction, we add an interaction term
\begin{equation}
	\hat{H}_\text{int}
	=
	-
	\int\frac{\dd{p}}{(2\pi)\sqrt{2p}}
	\left\{
		g(p)
		\hat{a}_1^\dagger(p)
		\hat{a}_2(p)
		+
		g(p)^*
		\hat{a}_2^\dagger(p)
		\hat{a}_1(p)
	\right\}
\end{equation}
describing a linear coupling with complex coupling factor $g(p)$.
The negative sign of the interaction Hamiltonian $\hat{H}_\text{int}$ ensures that our results are compatible with the sign conventions used in the literature.

% Actually, it is not true that the electromagnetic field is perfectly microscopic!
% The free electromagnetic field is microscopic, however, the guided field is in constant macroscopic interaction (elastic scattering) with the wave guide.
An inherent problem of interaction theory in quantum optics is that while the electromagnetic field is perfectly microscopic, the interactions of optical components are impossible to describe microscopically.
There have been attempts to incorporate the key properties of macroscopic medias into quantum field theory by employing topological Chern-Simons theory, for instance, Ref.~\cite{Pismak2014} recovers Snell's law - a macroscopic effect.
Unfortunately, these attempts require very advanced mathematics and appear to be still in development, meaning that the particular form of our interaction Hamiltonian appears still somewhat unsatisfyingly ad-hoc.
Another implicit assumption in quantum optics model is the independence of electromagnetic field modes.
In traditional quantum field theory, there is only one Maxwell field.
In quantum optics, we use macroscopic means to guide beams independent from another, i.e., space-like separated, justifying a description as independent fields.
However, one should acknowledge that there exists a theoretic gap in the correspondence of macroscopic interactions in terms of some effective parameters in quantum field theory.

The interaction Hamiltonian is time-independent and the interaction-picture time-evolution operator is exact with the first term of the Magnus expansion
\begin{equation}
	\hat{U}\left[g(p)\right](T)
	=
	\exp\left\{
		iT
		\int\frac{\dd{p}}{(2\pi)\sqrt{2p}}
		\left[
			g(p)
			\hat{a}_1^\dagger(p)
			\hat{a}_2(p)
			+
			g(p)^*
			\hat{a}_2^\dagger(p)
			\hat{a}_1(p)
		\right]
	\right\}
\end{equation}
with $T=t_1-t_0$ denoting the interaction time.
For instance, for a fiber coupler the interaction time $T$ is equal to the length $L$ where the waveguides are in close proximity parallel to another $L$ divided by the propagation speed of the medium $v$.
We reparametrize the couplings by incorporating the interaction time $T$ and the Lorentz-factor $1/\sqrt{2p}$ together with the absolute value of the complex coupling factor $g(p)$ into a real-valued coupling $\theta(p)$ and a phase-factor $e^{i\varphi(p)}$
\begin{equation}
	\hat{U}\left[\theta(p),\varphi(p)\right]
	=
	\exp\left\{
		i
		\int\frac{\dd{p}}{2\pi}
		\theta(p)
		\left[
			\hat{a}_1^\dagger(p)
			\hat{a}_2(p)
			e^{+i\varphi(p)}
			+
			\hat{a}_2^\dagger(p)
			\hat{a}_1(p)
			e^{-i\varphi(p)}
		\right]
	\right\}
	.
\end{equation}
In the interaction picture, the annihilation operators are time-dependent
\begin{equation}
	\hat{a}_i(p,t)
	=
	\hat{a}_i(p)e^{-ipt}
\end{equation}
and the coupling action transforms the operators according to
\begin{equation}
	\hat{a}_i^\prime(p,t)
	=
	\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
	\hat{a}_i(p,t)
	\hat{U}\left[\theta(p),\varphi(p)\right]
\end{equation}
which solves the Heisenberg equations of motion in the interaction picture.
Using a specific kind of \gls{bch} formula
\begin{equation}
	e^{\hat{X}}
	\hat{Y}
	e^{-\hat{X}}
	=
	\hat{Y}
	+
	\comm{\hat{X}}{\hat{Y}}
	+
	\frac{1}{2!}
	\comm{\hat{X}}{\comm{\hat{X}}{\hat{Y}}}
	+
	\frac{1}{3!}
	\comm{\hat{X}}{\comm{\hat{X}}{\comm{\hat{X}}{\hat{Y}}}}
	+
	\dots
\end{equation}
we define the transformed modes as output modes which in compact matrix notation
\begin{equation}
	\begin{split}
		\begin{pmatrix}
			\hat{a}_1^\prime(p,t)
			\\
			\hat{a}_2^\prime(p,t)
		\end{pmatrix}
		&=
		\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
		\begin{pmatrix}
			\hat{a}_1(p,t)
			\\
			\hat{a}_2(p,t)
		\end{pmatrix}
		\hat{U}\left[\theta(p),\varphi(p)\right]
		\\
		&=
		\begin{pmatrix}
			\cos[\theta(p)] & ie^{+i\varphi(p)}\sin[\theta(p)]
			\\
			ie^{-i\varphi(p)}\sin[\theta(p)] & \cos[\theta(p)]
		\end{pmatrix}
		\begin{pmatrix}
			\hat{a}_1(p,t)
			\\
			\hat{a}_2(p,t)
		\end{pmatrix}
	\end{split}
\end{equation}
recovers the unitary beam splitter transform in agreement with the single-mode transform reported in Ref.~\cite[p.~96]{Leonhardt2003} and Ref.~\cite[p.~130]{Haroche2006}.
An interesting remark is that the so derived beam splitter transform has only two \gls{dof} and it is not possible to accommodate more \gls{dof} in the coupling constant of the interaction Hamiltonian.
The absence of the global phase is easily explained by the fact that our Hamiltonian is invariant under global phase transformations.
The absence of a second local phase depends on the extension of the beam splitter component:
In the discussion of the general unitary transformation, a phase difference can be added between the incident and between the outgoing beams, requiring two local phase parameters in the transform.
However, the phase difference of the incident beams can also be factored into the coherent state of the incident beams.

\FloatBarrier
\subsection{Input-output relations for coherent states}

% TODO: reference time-evolution operator eq result from previous subsection
% TODO: reference time-dependent continuous-mode coherent state
% TODO: reference product of two displacement operators (using imaginary part in the exponential)

We are finally ready to show that the classical in- and output relations hold for coherent states.
In- and output coherent states are related by the previously derived time-evolution operator
\begin{equation}
	\hat{U}\left[\theta(p),\varphi(p)\right]
	\ket{\alpha_1(t),\alpha_2(t)}
	=
	\ket{\alpha_1^\prime(t),\alpha_2^\prime(t)}
	.
\end{equation}
Writing out the initial states in terms of the displacement operator-valued distributions
\begin{equation}
	\begin{split}
		\hat{U}\left[\theta(p),\varphi(p)\right]
		\ket{\alpha_1(t),\alpha_2(t)}
		&=
		\hat{U}\left[\theta(p),\varphi(p)\right]
		\hat{D}_1\left[\alpha_1(t,p)\right]
		\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
		\\
		&\times
		\hat{U}\left[\theta(p),\varphi(p)\right]
		\hat{D}_2\left[\alpha_2(t,p)\right]
		\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
		\ket{0}
	\end{split}
\end{equation}
where we inserted $\hat{U}^\dagger\hat{U}=\mathbb{I}$ between the displacement operators and used the uniqueness of the vacuum $\hat{U}^\dagger\ket{0}=\ket{0}$, we find the operator equation
\begin{equation}
	\hat{D}_1\left[\alpha_1^\prime(t,p)\right]
	\hat{D}_2\left[\alpha_2^\prime(t,p)\right]
	=
	\hat{U}
	\hat{D}_1\left[\alpha_1(t,p)\right]
	\hat{U}^\dagger
	\hat{U}
	\hat{D}_2\left[\alpha_2(t,p)\right]
	\hat{U}^\dagger
	.
\end{equation}
The idea is to calculate the transformed displacement operators on the right-hand side, reorder them by their corresponding mode, and then compare them with the left-hand side.
Finally, application to the vacuum state shows us the explicit relation between the in- and output coherent states.
Using the operator identity
\begin{equation}
	\hat{U}
	e^{\hat{X}}
	\hat{U}^\dagger
	=
	\sum_{n=0}^\infty
	\frac{1}{n!}
	\hat{U}
	\hat{X}^n
	\hat{U}^\dagger
	=
	\sum_{n=0}^\infty
	\frac{1}{n!}
	\left(
		\hat{U}
		\hat{X}
		\hat{U}^\dagger
	\right)^n
	=
	e^{\hat{U}\hat{X}\hat{U}^\dagger}
\end{equation}
the transformed displacement operator reads
\begin{equation}
	\begin{split}
		&\
		\hat{U}\left[\theta(p),\varphi(p)\right]
		\hat{D}_i\left[\alpha_i(t,p)\right]
		\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
		\\
		=&\
		\exp\biggl\{
			\int\frac{\dd{p}}{(2\pi)\sqrt{2p}}
			\bigl[
				\alpha_i(t,p)
				\left(
					\hat{U}\left[\theta(p),\varphi(p)\right]
					\hat{a}_i^\dagger(p)
					\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
				\right)^\dagger
				-
				\text{h.c.}
			\bigr]
		\biggr\}
		.
	\end{split}
\end{equation}
By nothing that
\begin{equation}
	\begin{split}
		\hat{U}\left[\theta(p),\varphi(p)\right]
		\hat{a}_i^\dagger(p)
		\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
		&=
		\left(
			\hat{U}\left[\theta(p),\varphi(p)\right]
			\hat{a}_i(p)
			\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
		\right)^\dagger
		\\
		&=
		\left(
			\hat{U}^\dagger\left[-\theta(p),\varphi(p)\right]
			\hat{a}_i(p)
			\hat{U}\left[-\theta(p),\varphi(p)\right]
		\right)^\dagger
	\end{split}
\end{equation}
we can reuse our result of the previous subsection to find
\begin{equation}
	\begin{split}
		&\
		\hat{U}\left[\theta(p),\varphi(p)\right]
		\begin{pmatrix}
			\hat{a}_1^\dagger(p,t)
			\\
			\hat{a}_2^\dagger(p,t)
		\end{pmatrix}
		\hat{U}^\dagger\left[\theta(p),\varphi(p)\right]
		\\
		=&\
		\begin{pmatrix}
			\cos[\theta(p)] & ie^{-i\varphi(p)}\sin[\theta(p)]
			\\
			ie^{+i\varphi(p)}\sin[\theta(p)] & \cos[\theta(p)]
		\end{pmatrix}
		\begin{pmatrix}
			\hat{a}_1^\dagger(p,t)
			\\
			\hat{a}_2^\dagger(p,t)
		\end{pmatrix}
	\end{split}
\end{equation}
we can use the previous derived transformation of the annihilation operators
Inserting the transformed annihilation operators back into the transformed displacement operators and moving the mixing and phase term to the functional, we arrive at
\begin{align}
	\hat{U}
	\hat{D}_1\left[\alpha_1(t,p)\right]
	\hat{U}^\dagger
	&=
	\hat{D}_1\left[\cos\theta(p)\alpha_1(t,p)\right]
	\hat{D}_2\left[i\sin\theta(p)e^{-i\varphi(p)}\alpha_1(t,p)\right]
	\\
	\hat{U}
	\hat{D}_2\left[\alpha_2(t,p)\right]
	\hat{U}^\dagger
	&=
	\hat{D}_1\left[i\sin\theta(p)e^{+i\varphi(p)}\alpha_2(t,p)\right]
	\hat{D}_2\left[\cos\theta(p)\alpha_2(t,p)\right]
\end{align}
and the operator equation reads
\begin{equation}
	\begin{split}
		\hat{D}_1\left[\alpha_1^\prime(t,p)\right]
		\hat{D}_2\left[\alpha_2^\prime(t,p)\right]
		&=
		\hat{D}_1\left[\cos\theta(p)\alpha_1(t,p)\right]
		\hat{D}_1\left[i\sin\theta(p)e^{-i\varphi(p)}\alpha_2(t,p)\right]
		\\
		&\times
		\hat{D}_2\left[i\sin\theta(p)e^{+i\varphi(p)}\alpha_1(t,p)\right]
		\hat{D}_2\left[\cos\theta(p)\alpha_2(t,p)\right]
	\end{split}
\end{equation}
where we used that the displacement operator of two independent modes commutes.
To further simplify the result, we use the product identity for the displacement operators of the first mode
\begin{equation}
	\begin{split}
		\hat{D}_1\left[\alpha_1^\prime(t,p)\right]
		&=
		\hat{D}_1\left[\cos\theta(p)\alpha_1(t,p)\right]
		\hat{D}_1\left[i\sin\theta(p)e^{-i\varphi(p)}\alpha_2(t,p)\right]
		\\
		&=
		\hat{D}_1\left[\cos\theta(p)\alpha_1(t,p)+i\sin\theta(p)e^{-i\varphi(p)}\alpha_2(t,p)\right]
		\\
		&\times
		\exp\left\{
			-i\int\frac{\dd{p}}{(2\pi)\sqrt{2p}}
			\Im[
				\cos\theta(p)\alpha_1(t,p)
				i\sin\theta(p)e^{+i\varphi(p)}\alpha_2(t,p)^*
			]
		\right\}
	\end{split}
\end{equation}
and do the same for the displacement operators of the second mode
\begin{equation}
	\begin{split}
		\hat{D}_2\left[\alpha_2^\prime(t,p)\right]
		&=
		\hat{D}_2\left[i\sin\theta(p)e^{+i\varphi(p)}\alpha_1(t,p)\right]
		\hat{D}_2\left[\cos\theta(p)\alpha_2(t,p)\right]
		\\
		&=
		\hat{D}_2\left[i\sin\theta(p)e^{+i\varphi(p)}\alpha_1(t,p)+\cos\theta(p)\alpha_2(t,p)\right]
		\\
		&\times
		\exp\left\{
			+i\int\frac{\dd{p}}{(2\pi)\sqrt{2p}}
			\Im[
				i\sin\theta(p)e^{+i\varphi(p)}\alpha_1(t,p)
				\cos\theta(p)\alpha_2(t,p)^*
			]
		\right\}
	\end{split}
	.
\end{equation}
Fortunately, the exponential phase factor of these two terms cancel and the product of the output displacement operators equals
\begin{equation}
	\begin{split}
		\hat{D}_1\left[\alpha_1^\prime(t,p)\right]
		\hat{D}_2\left[\alpha_2^\prime(t,p)\right]
		&=
		\hat{D}_1\left[\cos\theta(p)\alpha_1(t,p)+i\sin\theta(p)e^{+i\varphi(p)}\alpha_2(t,p)\right]
		\\
		&\times
		\hat{D}_2\left[i\sin\theta(p)e^{-i\varphi(p)}\alpha_1(t,p)+\cos\theta(p)\alpha_2(t,p)\right]
	\end{split}
	.
\end{equation}
Comparing the arguments of the displacement operators and using compact matrix notation, we find
\begin{equation}
	\begin{pmatrix}
		\alpha_1^\prime(t,p)
		\\
		\alpha_2^\prime(t,p)
	\end{pmatrix}
	=
	\begin{pmatrix}
		\cos\theta(p) & i\sin\theta(p)e^{+i\varphi(p)}
		\\
		i\sin\theta(p)e^{-i\varphi(p)} & \cos\theta(p)
	\end{pmatrix}
	\begin{pmatrix}
		\alpha_1(t,p)
		\\
		\alpha_2(t,p)
	\end{pmatrix}
\end{equation}
which is the same transformation we found in the classical case.
For the special case of the second input being the vacuum state, we have
\begin{equation}
	\hat{U}
	\ket{\alpha(t),0}
	=
	\ket{\alpha(t)\cos\theta(p),i\alpha(t)e^{-i\varphi(p)}\sin\theta(p)}
\end{equation}
which is in agreement with the time-independent single-mode result reported in Ref.~\cite[p.~134]{Haroche2006}.