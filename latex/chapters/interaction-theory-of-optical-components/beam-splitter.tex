\section{Classical free-ray beam splitter}\label{sec:beam_splitter}

Optical combiners and splitters, including the beam splitter and fiber coupler, are essential for many sophisticated experiments and devices.
For example, in quantum information theory, the beam splitter is an experimental realization of a quantum NOT gate~\cite{Adami1998}.
While an optical combiner superimposes (mixes) two optical signals, an optical splitter divides an input's power among two outputs.
From a physical perspective, the distinction between optical combiners and splitters becomes obsolete: the optical combiner and splitter are special cases of a linear passive optical component with two in- and outputs where either one in- or output is blocked.
More interestingly, a quantum mechanical description strictly requires two in- and outputs where one of the in- or outputs is assumed to be in the vacuum state.

A plethora of approaches towards the (quantum) beam splitter exists~\cite{Leonhardt2010,Gerry2005,Loudon2000}, ending with a unitary transform relating the electrical output to the input fields.\footnote{The optical beams are electromagnetic waves, yet given the electric field component, the magnetic field component follows from Maxwell's equations.}
We find that most of these descriptions are based on rather strong, not well-stated assumptions, leading to misconception and confusion, for example, regarding the phases and symmetry of the beam splitter.
In addition, we miss the link to imperfect implementations and the generalization to fiber components.

The chapter starts with a detailed review of the classical free-ray beam splitter, followed by a short review of the fiber coupler. After that, we present a generic model of a quantum mode coupler and provide extensions of the beam splitter and fiber coupler to quantum effects.

We start the review of the classical beam splitter with typical embodiments as a free-ray component.
We will find that there are only a few fundamental constraints on a generic beam splitter transformation.
Nevertheless, given the materials and dimensions, it is possible to model the transformation properties correctly.
Being sensitized for the difficulties of finding a general transformation for the beam splitter, we move on to an in-depth discussion of the ideal beam splitter described by a unitary transformation.
Finally, we end with a presentation of the scattering parameters of a generic but real beam splitter.

\subsection{Cubic, plate, and pellicle beam splitters}

The most commonly employed (free-ray) designs of the beam splitter are the cubic, plate, and pellicle beam splitters, see \Cref{fig:beam_splitter_types}.
\begin{figure}[htb]
    \centering
    \includestandalone{figures/tikz/beam-splitter-types}
    \caption{Cubic (a), plate (b), and pellicle (c) beam splitter.}\label{fig:beam_splitter_types}
\end{figure}
The cubic beam splitter is made of two triangular prisms. The interface between the two prisms is finished with a dielectric coating.
The outward-facing surface of the prisms is grafted with an \gls{ar} coating.\footnote{The incident angle of the electric field is perpendicular to the surface of the cubic beam splitter. As the reflection angle is equal to the incidence angle, we have back-reflection of the input fields. Back-reflection is discussed in \cref{sec:beam_splitter_scattering_parameters}.}
Compared to the plate and pellicle beam splitter, the cubic beam splitter has the highest loss and aberrations.
Nonetheless, the cubic beam splitter is a popular choice because of its simple integration into an optical setup.\footnote{The cubic beam splitter is significantly less sensitive to angular misalignment and mechanical vibrations.}
The pellicle beam splitter consists of a few micrometer thin membrane, optionally with a one-sided coating.
The small thickness of the membrane makes the pellicle beam splitter the most performant in terms of absorption and aberrations among the three designs.
Furthermore, the pellicle embodiment of the beam splitter supports a broad wavelength range.
The drawback of using a pellicle beam splitter is that they are highly susceptible to acoustic noise and require a precise angle to the incident beam.
The plate beam splitter is like a thick pellicle beam splitter made of glass.
Compared to the cubic and pellicle beam splitter's performance, the plate beam splitter is in-between concerning absorption, aberrations, and wavelength range.

Given two input beams, represented by the electrical field components $E_1(t)$ and $E_2(t)$, a beam splitter gives rise to two output beams, represented by the electrical field components $E_1^\prime(t)$ and $E_2^\prime(t)$.
\Cref{fig:beam_splitter_cube_plate} illustrates how the input and output fields emerge in the cubic and plate beam splitter.
The two input fields $E_1(t),E_2(t)$ are incident to the cubic and plate beam splitter's left and top, while the two output electric fields $E_1^\prime(t),E_2^\prime(t)$ exit the beam splitter at the right and bottom.
\begin{figure}[htb]
    \centering
    \includestandalone{figures/tikz/beam-splitter-cubic-plate}
    \caption{Cubic (left) and plate beam splitter (right) with two input beams represented by the electrical field components $E_1(t),E_2(t)$ and two output beam represented by the electrical field components $E_1^\prime(t),E_2^\prime(t)$. The frequency-dependent complex coefficients $r(\omega),r(\omega)^\prime$ and $t(\omega),t(\omega)^\prime$ fully characterize the reflection and transmission properties of the beam splitter.}\label{fig:beam_splitter_cube_plate}
\end{figure}
We assume the beam splitter to be a linear passive optical device, which suggests writing the relation between input and output fields given in the complex representation $\mathcal{E}(\omega)$ of the electric field component\footnote{The physical electrical field component $E(t)$ relates to the complex field $\mathcal{E}(t)$ via $E(t)=\Re\mathcal{E}(t)$. In the complex representation, phase shifts take the simple form of multiplications with a complex exponential. The frequency dependence coefficients are frequency-dependent, the linear transformation only holds in frequency space.} in the frequency domain\footnote{The frequency dependency of the reflection and transmission coefficients requires us to perform the linear transformation in frequency space.} as
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(\omega)
        \\
        \mathcal{E}_2^\prime(\omega)
    \end{pmatrix}
    =
    \begin{pmatrix}
        t(\omega) & r^\prime(\omega)
        \\
        r(\omega) & t^\prime(\omega)
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(\omega)
        \\
        \mathcal{E}_2(\omega)
    \end{pmatrix}
    \label{eq:beam_splitter_coefficients_transform}
\end{equation}
wherein $r(\omega),r^\prime(\omega)$ and $t(\omega),t^\prime(\omega)$ are the complex reflection respective transmission coefficients of the beam splitter.
The absolute value of the transmission $\abs{t(\omega)},\abs{t^\prime(\omega)}$ and reflection coefficients $\abs{r(\omega)},\abs{r^\prime(\omega)}$ determine the splitting ratio of the input power among the outputs.
The complex phase factor of the reflection and transmission coefficients characterize the phase shifts with which the input fields contribute to the output fields.

The beam splitter is a passive device, therefore, the optical output power is bound by the input power
\begin{equation}
    \abs{\mathcal{E}_1^\prime(\omega)}^2
    +
    \abs{\mathcal{E}_2^\prime(\omega)}^2
    \leq
    \abs{\mathcal{E}_1(\omega)}^2
    +
    \abs{\mathcal{E}_2(\omega)}^2
    \label{eq:beam_splitter_passive}.
\end{equation}
Inserting \cref{eq:beam_splitter_coefficients_transform} into \cref{eq:beam_splitter_passive} and setting the one of the input fields to zero, constraints the coefficients to
\begin{align}
    \abs{r(\omega)}^2+\abs{t(\omega)}^2\leq1,
    &&
    \abs{r^\prime(\omega)}^2+\abs{t^\prime(\omega)}^2\leq1
    \label{eq:beam_splitter_coefficients_constraint}.
\end{align}
Except for \cref{eq:beam_splitter_coefficients_constraint}, there are no further constraints to the coefficients describing a linear passive optical four-port in \cref{eq:beam_splitter_coefficients_transform}.
% TODO: is this even true? Don't we already assume with eq. (3.1.1) that there is no back-reflection?
Theorists often claim the transformation in \cref{eq:beam_splitter_coefficients_transform} to be symmetric (or reciprocal) due to Maxwell's equations~\cite[p.~129]{Haroche2006}.
Linear passive optical two-ports are only reciprocal for optical system with a single dielectric layer~\cite{Potton2004} but most physical beam splitters comprise multiple dielectric layers.\footnote{For example, cubic beam splitters have a coating followed by optical cement between the prisms breaking reciprocal symmetry of the system.}

Using classical wave optics and perfect knowledge of the dimensions and material properties, it is possible to derive exact expressions of the complex reflection $r(\omega),r^\prime(\omega)$ and transmission coefficients $t(\omega),t^\prime(\omega)$.
For example, HÃ©nault~\cite{Henault2015} derived an exact expression for the reflected and transmitted amplitudes of a plate beam splitter with one input and a single dielectric layer.
Likewise, Hamilton~\cite{Hamilton2000} discusses the cubic beam splitter with two inputs and different coatings.
In general, the complex reflection and transmission coefficients need to account for multiple reflections at different dielectric layers inside the beam splitter.

We conclude that given exact knowledge of the design parameters, we can find a physical model describing the complex reflection and transmission coefficients.
Unfortunately, these parameters are rarely available and are subject to manufacturing variations.
The situation worsens for fiber optics, where only limited physical parameters are accessible without breaking the device.
% TODO: conclusion?

\subsection{Unitary transformation of an ideal beam splitter}

We define an ideal beam splitter as a linear passive optical four-port that is
\begin{enumerate}
    \item lossless (the energy of the input fields is equal to the energy of the output fields), and
    \item independent of frequency (for the frequency range of the input fields).
\end{enumerate}
In this case, the transformation relating the output with the input fields is unitary.\footnote{Unitary transformations preserve the inner product and $\abs{\mathcal{E}_1}^2+\abs{\mathcal{E}_2}^2=\abs{\mathcal{E}^\prime_1}^2+\abs{\mathcal{E}^\prime_2}^2$ is the norm of the input and output vectors induced by the inner product. As a consequence, a unitary transform $\hat{U}$ satisfies $\hat{U}^{-1}=\hat{U}^\dagger$.}
In general, the unitary transformation describing a lossless beam splitter has four \gls{dof}.\footnote{The beam splitter is described by a linear map $\hat{U}\colon\mathbb{C}^2\to\mathbb{C}^2$ which has eight \gls{dof}. $\hat{U}\hat{U}^\dagger=\mathbb{1}$ removes four \gls{dof}.}
Different parametrizations towards a two-dimensional unitary transformation exist.
In the previous section, we used a parametrization, \cref{eq:beam_splitter_coefficients_transform}, based on the polar representation of the complex reflection and transmission coefficients.
Alternatively, a parametrization involving the Pauli matrices is used in the literature, see, for instance, Ref.~\cite{Zeilinger1981}.
In the following, we use a parametrization introduced by Leonhardt~\cite[p.~92]{Leonhardt2010}
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    e^{i\Lambda}
    \begin{pmatrix}
        e^{+i\Phi} & 0
        \\
        0 & e^{-i\Phi}
    \end{pmatrix}
    \begin{pmatrix}
        \cos\Theta & \sin\Theta
        \\
        -\sin\Theta & \cos\Theta
    \end{pmatrix}
    \begin{pmatrix}
        e^{+i\Psi} & 0
        \\
        0 & e^{-i\Psi}
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform}
\end{equation}
parametrized by the angles $\Lambda,\Theta,\Psi,\Phi\in\mathbb{R}$.
The parametrization of \cref{eq:beam_splitter_unitary_transform} allows for a physical interpretation without assumptions of a physical model.
More precisely, the matrix product in \cref{eq:beam_splitter_unitary_transform} reads as the composition of a phase transform of $\pm\Psi$ applied to the input fields, a mixing of the input fields with angle $\Theta$, and a phase transform of $\pm\Phi$ applied to the mixed fields, in addition, the output fields pick up a global phase $\Lambda$ from the optical path length common to the beams.\footnote{Even the global phase $\Lambda$ becomes local, and thereby measurable, if we consider the beam splitter to be only part of a subsystem, see \cref{sec:mach_zehnder_modulator}.}

If we carry out the matrix multiplication in \cref{eq:beam_splitter_unitary_transform}, we find
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    e^{i\Lambda}
    \begin{pmatrix}
        e^{i(+\Phi+\Psi)}\cos\Theta & e^{i(+\Phi-\Psi)}\sin\Theta
        \\
        -e^{i(-\Psi+\Phi)}\sin\Theta & e^{i(-\Psi-\Phi)}\cos\Theta
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix},
\end{equation}
we introduce $\phi=(\Phi+\Psi)/2,\psi=(\Phi-\Psi)/2$ and write
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    e^{i\Lambda}
    \begin{pmatrix}
        e^{+i\psi/2}\cos\Theta & e^{i\phi/2}\sin\Theta
        \\
        e^{-i\phi/2+i\pi}\sin\Theta & e^{-i\psi/2}\cos\Theta
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_expanded}.
\end{equation}
For $\Theta=0$ and $\Theta=\pi/2$ there is no mixing, yet, there is a subtle difference between these cases.
In the case of $\Theta=0$, \cref{eq:beam_splitter_unitary_transform_expanded} becomes
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    e^{i\Lambda}
    \begin{pmatrix}
        e^{+i\psi/2} & 0
        \\
        0 & e^{-i\psi/2}
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    =
    e^{i\Lambda}
    \begin{pmatrix}
        \mathcal{E}_1(t)e^{+i\psi/2}
        \\
        \mathcal{E}_2(t)e^{-i\psi/2}
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_transmission},
\end{equation}
in other words, an additional phase difference of $\psi$ is added between the output fields.
In the case of $\Theta=\pi/2$, \cref{eq:beam_splitter_unitary_transform_expanded} becomes
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    e^{i\Lambda}
    \begin{pmatrix}
        0 & e^{+i\phi/2}
        \\
        e^{-i\psi/2+i\pi} & 0
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    =
    e^{i\Lambda}
    \begin{pmatrix}
        \mathcal{E}_2(t)e^{+i\phi/2}
        \\
        \mathcal{E}_1(t)e^{-i\phi/2+i\pi}
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_reflection},
\end{equation}
and a phase difference of $\pi-\phi$ is added between the output fields.
The difference between these two phase shifts between the output fields yields $\phi+\psi=\pi$.
If we identify $\Theta=0$ with the transmitted and $\Theta=\pi/2$ with the reflected field\footnote{Only the physical models have a notion of reflectance and transmittance. For the unitary transformation there is no fundamental difference between $\Theta=0,\pi/2$ as the $\pi$ phase can be moved around by reparamtrization.}, we recover the statement~\cite{Zeilinger1981} that the phase shift between the transmitted and reflected fields of an ideal beam splitter adds up to $\pi$.\footnote{The statement should not be confused with the statement that the phase difference between the output fields are phase-shifted by $\pi$.}

Evidently, the phases $\psi,\phi$ are a source of confusion and require a thorough examination.
For simplicity, we assume a balanced lossless beam splitter which distributes the input power equally among the outputs.
The corresponding transformation is obtained by setting $\Theta=\pi/4$ in \cref{eq:beam_splitter_unitary_transform}
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    \frac{e^{i\Lambda}}{\sqrt{2}}
    \begin{pmatrix}
        e^{i\phi} & e^{i\psi}
        \\
        -e^{-i\psi} & e^{-i\phi}
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    =
    \frac{e^{i\Lambda}}{\sqrt{2}}
    \begin{pmatrix}
        \mathcal{E}_1(t)e^{i\phi}+\mathcal{E}_2(t)e^{i\psi}
        \\
        \mathcal{E}_1(t)e^{-i\psi+i\pi}+\mathcal{E}_2(t)e^{-i\phi}
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_balanced}.
\end{equation}
\Cref{eq:beam_splitter_unitary_transform_balanced} cannot be simplified without further assumptions\footnote{In principle, the dimensions, materials and coatings of a physical beam splitter can be chosen such that $\psi,\phi,\Lambda$ can take arbitrary values.}.
In the quantum optics literature, for instance, Ref.~\cite[p.~138]{Gerry2005}, we frequently find the claim that
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        1 & i\\
        i & 1
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_balanced_qo}
\end{equation}
describes an ideal balanced beam splitter.
Moreover, the quantum communication literature, for example, Ref.~\cite{Shapiro2009}, uses
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        1 & -1\\
        1 & 1
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_balanced_qc},
\end{equation}
which has the merit that we can write $\mathcal{E}_\pm(t)=\left(\mathcal{E}_1(t)\pm\mathcal{E}_2(t)\right)/\sqrt{2}$, as the transformation of an ideal balanced beam splitter.
While \cref{eq:beam_splitter_unitary_transform_balanced_qo} corresponds to $\Lambda=0,\psi=0,\phi=\pi/2$ in \cref{eq:beam_splitter_unitary_transform_balanced}, and \cref{eq:beam_splitter_unitary_transform_balanced_qc} can be obtained with $\Lambda=0,\phi=0,\psi=\pi$, we rarely find a justification to remove three physical \gls{dof}.
If we assume an ideal beam splitter to be
\begin{enumerate}
    \item no other fields except for the input fields to be in the system, and
    \item symmetric with respect to the input fields,
\end{enumerate}
it is possible to derive \cref{eq:beam_splitter_unitary_transform_balanced_qo} from \cref{eq:beam_splitter_unitary_transform_balanced}.
The first assumption lets us remove two \gls{dof}: first, $\Lambda$ is a global phase that cannot be measured, and we are free to choose $\Lambda$ as convenient, second, we are allowed to choose a common phase origin.
Let us explicitly write $\mathcal{E}_1(t)e^{i\delta_1}$ and $\mathcal{E}_2(t)e^{i\delta_2}$.
By adjusting the global phase $\Lambda$ accordingly, this is equivalent to $\mathcal{E}_1(t)e^{i\Delta\delta}$ and $\mathcal{E}_2(t)$ wherein $\Delta\delta=\delta_1-\delta_2$, and we can rewrite \cref{eq:beam_splitter_unitary_transform_balanced} as
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
        e^{i(\phi/2+\Delta\theta)} & e^{i\psi/2}
        \\
        -e^{-i(\psi/2-\Delta\theta)} & e^{-i\phi/2}
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    \label{eq:beam_splitter_unitary_transform_balanced_phase_origin}.
\end{equation}
By the second assumption, $e^{i\psi/2}=-e^{i(\psi/2-\Delta\delta)}$, or equivalently, $\psi=\pi/2+\Delta\delta/2$ and \cref{eq:beam_splitter_unitary_transform_balanced_phase_origin} becomes
\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_1^\prime(t)
        \\
        \mathcal{E}_2^\prime(t)
    \end{pmatrix}
    =
    \frac{e^{i\Delta\delta/2}}{\sqrt{2}}
    \begin{pmatrix}
        e^{i(\phi+\Delta\delta/2)} & i
        \\
        i & e^{-i(\phi+\Delta\delta/2)}
    \end{pmatrix}
    \begin{pmatrix}
        \mathcal{E}_1(t)
        \\
        \mathcal{E}_2(t)
    \end{pmatrix}
    .
\end{equation}
Removing the global phase and choosing the phase reference such that $\phi+\Delta\delta=0$ finally yields \cref{eq:beam_splitter_unitary_transform_balanced_qo}.
The assumption of a symmetric beam splitter is not justified for most physical beam splitters\footnote{See the discussion of physcial beam splitter types in \cref{sec:beam_splitter}.}.
Furthermore, the requirement that the optical system comprises only two beams massively restricts the use of \cref{eq:beam_splitter_unitary_transform_balanced_qo}.
That said, the assumptions of our ideal beam splitter are already very strong and in contrast to \cref{eq:beam_splitter_unitary_transform_balanced}, \cref{eq:beam_splitter_unitary_transform_balanced_qo} and \cref{eq:beam_splitter_unitary_transform_balanced_qc} allow simple calculations.

\subsection{Scattering parameters of a real beam splitter}

% TODO: cite reference where reflection and transmission properties are measured

\begin{figure}[htb]
    \centering
    \includestandalone{figures/tikz/four-port}
    \caption{In- and outputs of a beam splitter used for the scattering parameter model.}\label{fig:beam_splitter_scattering_parameters}
\end{figure}

\begin{equation}
    \begin{pmatrix}
        \mathcal{E}_{1,\text{out}} \\
        \mathcal{E}_{2,\text{out}} \\
        \mathcal{E}_{3,\text{out}} \\
        \mathcal{E}_{4,\text{out}}
    \end{pmatrix}
    =
    T
    \begin{pmatrix}
        \mathcal{E}_{1,\text{in}} \\
        \mathcal{E}_{2,\text{in}} \\
        \mathcal{E}_{3,\text{in}} \\
        \mathcal{E}_{4,\text{in}}
    \end{pmatrix}
\end{equation}
where $T\in\mathbb{C}^{4\times4}$.

\begin{figure}[htb]
    \centering
    \includegraphics{figures/pstricks/optical-network-analyzer}
    \caption{Experimental setup of an optical network analyzer measuring the scattering parameters of a real beam splitter.}\label{fig:beam_splitter_network_analyzer}
\end{figure}
