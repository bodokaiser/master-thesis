\section{Relativistic field theory}

\rem
\begin{proof}
	According to the action principle, the dynamics of the field are determined by the equations of motion which can be found by the relativistic Euler-Lagrange equations
	\begin{equation*}
		0
		=
		\partial_\mu\pdv{\mathcal{L}}{(\partial_\mu\phi)}
		-
		\pdv{\mathcal{L}}{\phi}
		=
		\left(
			\partial_\mu\partial^\mu
			+
			m^2
		\right)
		\phi(t,\vb{x})
		.
	\end{equation*}
	Assuming the existence of the Klein-Gordon field's Fourier representation\footnote{See Ref.~\cite[p.~341]{Cohen2019} for a definition of a Minkowski Fourier transform.}
	\begin{equation*}
		\phi(t,\vb{x})
		=
		\int_{\mathbb{R}^3}\frac{\dd[3]{p}}{(2\pi)^3}
		\phi(t,\vb{p})
		e^{-i\vb{p}\vdot\vb{x}}
		=
		\int_{\mathbb{R}^4}\frac{\dd[4]{p}}{(2\pi)^4}
		\phi(p_0,\vb{p})
		e^{+ip_\mu x^\mu}
		,
	\end{equation*}
	the equation of motion in momentum space reduces to
	\begin{equation*}
		0
		=
		\left(
			ip_\mu ip^\mu
			+
			m^2
		\right)
		\phi(p_0,\vb{p})
		=
		-
		\left(
			p_0^2
			-
			\omega(\vb{p})^2
		\right)
		\phi(p_0,\vb{p})
	\end{equation*}
	which is satisfied if $p_0=\pm\omega(\vb{p})$.
\end{proof}

\kgmodeexp
\begin{proof}
	There are two approaches to prove \cref{thm:kg_mode_expansion}.
	In a first approach, we calculate with the proposed Fourier expansion
	\begin{equation*}
		\begin{split}
			\partial_\mu
			\partial^\mu
			\phi(t,\vb{x})
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\left\{
				a^*(\vb{p})
				\partial_\mu
				\partial^\mu
				e^{-ip_\mu x^\mu}
				+
				\text{c.c.}
			\right\}_{p_0=\omega(\vb{p})}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\left\{
				a^*(\vb{p})
				\left(
					-
					p_\mu
					p^\mu
				\right)
				e^{-ip_\mu x^\mu}
				+
				\text{c.c.}
			\right\}_{p_0=\omega(\vb{p})}
		\end{split}
	\end{equation*}
	where $p_\mu p^\mu=\omega(\vb{p})^2-\vb{p}=m^2$ and therefore the equation of motion
	\begin{equation*}
			\partial_\mu
			\partial^\mu
			\phi(t,\vb{x})
			=
			-
			m^2
			\phi(t,\vb{x})
	\end{equation*}
	is satisfied.
	While the first approach successfully shows why the theorem is true, it is not obvious how to arrive at the Fourier expansion.
	Therefor, a second approach starts with the Fourier transform of the Klein-Gordon field
	\begin{equation*}
		\phi(t,\vb{x})
		=
		\int_V\frac{\dd[4]{p}}{(2\pi)^4}
		\phi(p_0,\vb{p})
		e^{+ip_\mu x^\mu}
	\end{equation*}
	where the integration domain is constrained to the momentum lightcone $V$ and therefore $\omega(\vb{p})^2=p_0^2$ is automatically satisfied.
	We are left to rewrite the constrained integration domain
	\begin{equation*}
		\phi(t,\vb{x})
		=
		\int_{\mathbb{R}^4}\frac{\dd[4]{p}}{(2\pi)^3}
		\delta^{(1)}\left(p_0^2-\omega(\vb{p})^2\right)
		\phi(p_0,\vb{p})
		e^{+ip_\mu x^\mu}
	\end{equation*}
	and using the composition property of the delta distribution
	\begin{equation*}
		\delta^{(1)}\left(p_0^2-\omega(\vb{p})^2\right)
		=
		\frac{
			\delta^{(1)}\left(p_0-\omega(\vb{p})\right)
			+
			\delta^{(1)}\left(p_0+\omega(\vb{p})\right)
		}{\sqrt{2\omega(\vb{p})}}
	\end{equation*}
	which leaves us with
	\begin{equation*}
		\phi(t,\vb{x})
		=
		\int_{\mathbb{R}^3}\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
		\biggl\{
			\phi(\omega(\vb{p}),\vb{p})
			e^{+i\omega(\vb{p})t}
			+
			\phi(-\omega(\vb{p}),\vb{p})
			e^{-i\omega(\vb{p})t}
		\biggr\}
		e^{-i\vb{p}\vdot\vb{x}}
		.
	\end{equation*}
	We now only need to perform the substitution $\vb{p}\to-\vb{p}$ on the second term
	\begin{equation*}
		\begin{split}
			\phi(t,\vb{x})
			&=
			\int_{\mathbb{R}^3}\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\biggl\{
				\phi(\omega(\vb{p}),\vb{p})
				e^{+i\omega(\vb{p})t}
				e^{-i\vb{p}\vdot\vb{x}}
				+
				\phi(-\omega(\vb{p}),\vb{p})
				e^{-i\omega(\vb{p})t}
				e^{-i\vb{p}\vdot\vb{x}}
			\biggr\}
			\\
			&=
			\int_{\mathbb{R}^3}\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\biggl\{
				\phi(\omega(\vb{p}),\vb{p})
				e^{+i\omega(\vb{p})t}
				e^{-i\vb{p}\vdot\vb{x}}
				+
				\phi(-\omega(\vb{p}),-\vb{p})
				e^{-i\omega(\vb{p})t}
				e^{+i\vb{p}\vdot\vb{x}}
			\biggr\}
			\\
			&=
			\int_{\mathbb{R}^3}\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\biggl\{
				\phi(\omega(\vb{p}),\vb{p})
				e^{+ip_\mu x^\mu}
				+
				\phi(\omega(\vb{p}),\vb{p})^*
				e^{-ip_\mu x^\mu}
			\biggr\}_{p_0=\omega(\vb{p})}
		\end{split}
	\end{equation*}
	and use the conjugate symmetry of the Fourier amplitudes
	\begin{equation*}
		\phi(p_0,\vb{p})^*
		=
		\phi(-p_0,-\vb{p})
	\end{equation*}
	which is present because $\phi(t,\vb{x})$ is real-valued.
\end{proof}

\Cref{thm:kg_energy_density}, \Cref{thm:kg_energy_momentum}, and \Cref{thm:kg_conjugate_momentum} are found in standard literature on relativistic field theory, for instance, in Ref.~\cite{Peskin1995}.

\section{Canonical quantization}

\qkgcommac
\begin{proof}
	The equal-time commutation relations are valid for any time $t$ so also for $t=0$, inserting \cref{eq:qkg_pos} into \cref{eq:qkg_comm_pm}, we find
	\begin{equation*}
		\begin{split}
			0
			=
			\comm{\hat\phi(0,\vb{x})}{\hat\phi(0,\vb{y})}
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3}
			\frac{1}{\sqrt{2\omega(\vb{p})}}
			\int\frac{\dd[3]{q}}{(2\pi)^3}
			\frac{1}{\sqrt{2\omega(\vb{q})}}
			\\
			&\times
			\comm{
				\hat{a}(\vb{p})
				e^{+i\vb{p}\vdot\vb{x}}
				+
				\hat{a}^\dagger(\vb{p})
				e^{-i\vb{p}\vdot\vb{x}}
			}{
				\hat{a}(\vb{q})
				e^{+i\vb{q}\vdot\vb{y}}
				+
				\hat{a}^\dagger(\vb{q})
				e^{-i\vb{q}\vdot\vb{y}}
			}
			,
		\end{split}
	\end{equation*}
		and for \cref{eq:qkg_mom}, we find
	\begin{equation*}
		\begin{split}
			0
			=
			\comm{\hat\phi(0,\vb{x})}{\hat\phi(0,\vb{y})}
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3}
			\left(
				-i
				\sqrt{\frac{\omega(\vb{p})}{2}}
			\right)
			\int\frac{\dd[3]{q}}{(2\pi)^3}
			\left(
				-i
				\sqrt{\frac{\omega(\vb{q})}{2}}
			\right)
			\\
			&\times
			\comm{
				\hat{a}(\vb{p})
				e^{+i\vb{p}\vdot\vb{x}}
				-
				\hat{a}^\dagger(\vb{p})
				e^{-i\vb{p}\vdot\vb{x}}
			}{
				\hat{a}(\vb{q})
				e^{+i\vb{q}\vdot\vb{y}}
				-
				\hat{a}^\dagger(\vb{q})
				e^{-i\vb{q}\vdot\vb{y}}
			}
			.
		\end{split}
	\end{equation*}
	The double integral is zero iff the integrand is zero, therefore
	\begin{align*}
		\comm{
			\hat{a}(\vb{p})
			e^{+i\vb{p}\vdot\vb{x}}
			+
			\hat{a}^\dagger(\vb{p})
			e^{-i\vb{p}\vdot\vb{x}}
		}{
			\hat{a}(\vb{q})
			e^{+i\vb{q}\vdot\vb{y}}
			+
			\hat{a}^\dagger(\vb{q})
			e^{-i\vb{q}\vdot\vb{y}}
		}
		&=
		0
		\\
		\comm{
			\hat{a}(\vb{p})
			e^{+i\vb{p}\vdot\vb{x}}
			-
			\hat{a}^\dagger(\vb{p})
			e^{-i\vb{p}\vdot\vb{x}}
		}{
			\hat{a}(\vb{q})
			e^{+i\vb{q}\vdot\vb{y}}
			-
			\hat{a}^\dagger(\vb{q})
			e^{-i\vb{q}\vdot\vb{y}}
		}
		&=
		0
		.
	\end{align*}
	Adding and subtracting these equations from another implies
	\begin{equation*}
		\comm{\hat{a}(\vb{p})}{\hat{a}(\vb{q})}
		=
		0
		=
		\comm{\hat{a}^\dagger(\vb{p})}{\hat{a}^\dagger(\vb{q})}
		.
	\end{equation*}
	Finally, inserting \cref{eq:qkg_pos} and \cref{eq:qkg_mom} into \cref{eq:qkg_comm_pm}, reveals
	\begin{equation*}
		\begin{split}
			i\delta^{(3)}(\vb{x}-\vb{y})
			=
			\comm{\hat\phi(0,\vb{x})}{\hat\pi(0,\vb{y})}
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3}
			\frac{1}{\sqrt{2\omega(\vb{p})}}
			\int\frac{\dd[3]{q}}{(2\pi)^3}
			\left(
				-i
				\sqrt{\frac{\omega(\vb{q})}{2}}
			\right)
			\\
			&\times
			\comm{
				\hat{a}(\vb{p})
				e^{+i\vb{p}\vdot\vb{x}}
				+
				\hat{a}^\dagger(\vb{p})
				e^{-i\vb{p}\vdot\vb{x}}
			}{
				\hat{a}(\vb{q})
				e^{+i\vb{q}\vdot\vb{y}}
				-
				\hat{a}^\dagger(\vb{q})
				e^{-i\vb{p}\vdot\vb{y}}
			}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3}
			\int\frac{\dd[3]{q}}{(2\pi)^3}
			\left(
				-
				\frac{i}{2}
				\sqrt{\frac{\omega(\vb{q})}{\omega(\vb{p})}}
			\right)
			\\
			&\times
			\left\{
				-
				\comm{\hat{a}(\vb{p})}{\hat{a}^\dagger(\vb{q})}
				e^{+i\vb{p}\vdot\vb{x}}
				e^{-i\vb{q}\vdot\vb{y}}
				+
				\comm{\hat{a}^\dagger(\vb{p})}{\hat{a}(\vb{q})}
				e^{-i\vb{p}\vdot\vb{x}}
				e^{+i\vb{q}\vdot\vb{y}}
			\right\}
		\end{split}
	\end{equation*}
	which is satisfied for
	\begin{equation*}
		\comm{\hat{a}(\vb{p})}{\hat{a}^\dagger(\vb{q})}
		=
		(2\pi)^3
		\delta^{(3)}(\vb{q}-\vb{p})
		.
	\end{equation*}
\end{proof}

\qkgcommpn
\begin{proof}
	That positive respective negative frequency Klein-Gordon operators commute follows from \Cref{thm:qkg_comm_ac}.
	Using \Cref{thm:qkg_comm_ac} for the remaining commutator
	\begin{equation*}
		\begin{split}
			\comm{\hat\phi^+(x^\mu)}{\hat\phi^-(y^\mu)}
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\int\frac{\dd[3]{q}}{(2\pi)^3\sqrt{2\omega(\vb{q})}}
			\comm{\hat{a}(\vb{p})}{\hat{a}^\dagger(\vb{p})}
			\eval{
				e^{-ip_\mu x^\mu}
				e^{+iq_\mu y^\mu}
			}_{\substack{p_0=\omega(\vb{p})\\q_0=\omega(\vb{q})}}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^32\omega(\vb{p})}
			\eval{
				e^{-ip_\mu(x^\mu-y^\mu)}
			}_{p_0=\omega(\vb{p})}
			=
			D(x^\mu-y^\mu)
		\end{split}
	\end{equation*}
	recovers the initial claim after identification of the Klein-Gordon propagator.
\end{proof}
\qkgpropcorr
\begin{proof}
	Decomposing the Klein-Gordon operator into positive and negative frequency and using \Cref{thm:vacuum_state_pn}, we find
	\begin{equation*}
		\begin{split}
			\expval{\hat\phi(x^\mu)\hat\phi(y^\mu)}{0}
			&=
			\expval{\hat\phi^+(x^\mu)\hat\phi^-(y^\mu)}{0}
			\\
			&=
			\expval{\comm{\hat\phi^+(x^\mu)}{\hat\phi^-(y^\mu)}}{0}
			\\
			&=
			\expval{D(x^\mu-y^\mu)}{0}
			\\
			&=
			D(x^\mu-y^\mu)
		\end{split}
	\end{equation*}
	where we used \Cref{thm:qkg_comm_pn}.
\end{proof}

\section{Relativistic wave packets}

\nonrelativisticgaussianmom
\begin{proof}
	For massless particles, we have $p_\mu p^\mu=0=k_\mu k^\mu$ and \cref{eq:covariant_gaussian_spectrum} reduces to
	\begin{equation*}
		f(\vb{p})
		\propto
		\exp\left\{
			-
			\frac{\omega(\vb{p})\omega(\vb{k})-\vb{p}\vdot\vb{k}}{2\sigma^2}
		\right\}
		.
	\end{equation*}
	For $\omega(\vb{p})\ll\sigma$, we perform a Taylor expansion around $\vb{k}$
	\begin{equation*}
		\omega(\vb{p})
		=
		\omega(\vb{k})
		+
		\omega^\prime(\vb{k})
		\vdot
		(\vb{p}-\vb{k})
		+
		\frac{1}{2}
		(\vb{p}-\vb{k})^\trans
		\omega^{\prime\prime}(\vb{k})
		(\vb{p}-\vb{k})
		+
		\order{\vb{p}^3}
	\end{equation*}
	where $\omega^\prime(\vb{k})=\vb{k}/\omega(\vb{k})$ denotes the gradient and $\omega^{\prime\prime}(\vb{k})$ the Hessian of $\omega(\vb{p})$ evaluated at $\vb{k}$ and further reducing the spectrum to
	\begin{equation*}
		f(\vb{p})
		\propto
		\exp\left\{
			-
			\frac{
				(\vb{p}-\vb{k})^\trans
				\omega(\vb{k})
				\omega^{\prime\prime}(\vb{k})
				(\vb{p}-\vb{k})
			}{4\sigma^2}
		\right\}
		.
	\end{equation*}
	The expressions
	\begin{equation*}
		\omega(\vb{k})
		\omega^{\prime\prime}(\vb{k})_{ij}
		=
		\omega(\vb{k})
		\pdv{\omega(\vb{k})}{k_i}{k_j}
		=
		\delta_{ij}
		-
		\frac{k_ik_j}{\omega(\vb{k})^2}
		=
		\delta_{ij}
		-
		\frac{k_ik_j}{\vb{k}^2}
	\end{equation*}
	turns out to be equal to the transverse projector $P_T(\vb{k})$ which projects out the components orthogonal to $\vb{k}$.
	Inserting the transverse project, we find the non-relativistic Gaussian spectrum to be approximately equal to
	\begin{equation*}
		f(\vb{p})
		\propto
		\exp\left\{
			-
			\frac{
				(\vb{p}-\vb{k})^\trans
				P_T(\vb{k})
				(\vb{p}-\vb{k})
			}{4\sigma^2}
		\right\}
		=
		\exp\left\{
			-
			\frac{
				\vb{p}_T^2
			}{4\sigma^2}
		\right\}
		.
	\end{equation*}
	The final result is confirmed by Ref.~\cite[eq.~(25)]{Naumov2013} when removing the longitudinal momentum component.
\end{proof}

\section{Number states}

\qkgnumbersingleinner
\begin{proof}
	Inserting the definition of the number state for $n=1$
	\begin{equation*}
		\begin{split}
			\braket{1_f}{1_g}
			&=
			\expval{
				\left(
					\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
					f(\vb{p})
					\hat{a}^\dagger(\vb{p})
				\right)^\dagger
				\left(
					\int\frac{\dd[3]{q}}{(2\pi)^3\sqrt{2\omega(\vb{q})}}
					g(\vb{q})
					\hat{a}^\dagger(\vb{q})
				\right)
			}{0}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			f(\vb{p})^*
			\int\frac{\dd[3]{q}}{(2\pi)^3\sqrt{2\omega(\vb{q})}}
			g(\vb{q})
			\expval{\hat{a}(\vb{p})\hat{a}^\dagger(\vb{q})}{0}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			f(\vb{p})^*
			\int\frac{\dd[3]{q}}{(2\pi)^3\sqrt{2\omega(\vb{q})}}
			g(\vb{q})
			\comm{\hat{a}(\vb{p})}{\hat{a}^\dagger(\vb{q})}
			\braket{0}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			f(\vb{p})^*
			\int\frac{\dd[3]{q}}{(2\pi)^3\sqrt{2\omega(\vb{q})}}
			g(\vb{q})
			(2\pi)^3\delta^{(3)}(\vb{q}-\vb{p})
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^32\omega(\vb{p})}
			f(\vb{p})^*
			g(\vb{p})
		\end{split}
	\end{equation*}
	where we used $\hat{a}(\vb{p})\ket{0}=0$ and $\braket{0}=1$ to rewrite the expectation value as commutator.
\end{proof}

\qkgnumbersmearing
\begin{proof}
	Comparing \cref{eq:qkg_number_state_smearing} and \cref{eq:qkg_number_state} leaves us with showing
	\begin{equation*}
		\int\dd[4]{x}
		f(x^\mu)
		\hat\phi^-(x^\mu)
		=
		\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
		f(\vb{p})
		\hat{a}^\dagger(\vb{p})
		.
	\end{equation*}
	Inserting the negative frequency Klein-Gordon operator, \cref{eq:qkg_positive_negative_frequency}, into the left-hand side yields
	\begin{equation*}
		\begin{split}
			\int\dd[4]{x}
			f(x^\mu)
			\hat\phi^-(x^\mu)
			&=
			\int\dd[4]{x}
			f(x^\mu)
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\eval{
				e^{+ip_\mu x^\mu}
				\hat{a}^\dagger(\vb{p})
			}_{p_0=\omega(\vb{p})}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\left(
				\int\dd[4]{x}
				f(x^\mu)
				e^{+ip_\mu x^\mu}
			\right)_{p_0=\omega(\vb{p})}
			\hat{a}^\dagger(\vb{p})
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			\eval{f(p^\mu)}_{p_0=\omega(\vb{p})}
			\hat{a}^\dagger(\vb{p})
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			f\left(\omega(\vb{p}),\vb{p}\right)
			\hat{a}^\dagger(\vb{p})
		\end{split}
	\end{equation*}
	which equals the right-hand side when we take $f(\vb{p})=f\left(\omega(\vb{p}),\vb{p}\right)$.
\end{proof}
\qkgcommsmearedpn
\begin{proof}
	Proof by induction for $n\in\mathbb{N}$.
	\begin{enumerate}
		\item Induction start ($n=1$):
		\begin{equation*}
			\begin{split}
				\comm{\hat\phi^+[f]}{\hat\phi^-[g]}
				&=
				\int\dd[4]{x}f(x^\mu)
				\int\dd[4]{y}g(y^\mu)
				\comm{\hat\phi^+(x^\mu)}{\hat\phi^-(y^\mu)}
				\\
				&=
				\int\dd[4]{x}f(x^\mu)
				\int\dd[4]{y}g(y^\mu)
				D(x^\mu-y^\mu)
				\\
				&=
				\int\dd[4]{x}f(x^\mu)
				\int\dd[4]{y}g(y^\mu)
				\int\frac{\dd[3]{p}}{(2\pi)^32\omega(\vb{p})}
				\eval{e^{-ip_\mu(x^\mu-y^\mu)}}_{p_0=\omega(\vb{p})}
				\\
				&=
				\int\frac{\dd[3]{p}}{(2\pi)^32\omega(\vb{p})}
				\left(
					\int\dd[4]{x}
					f(x^\mu)
					e^{+ip_\mu x^\mu}
				\right)^*_{p_0=\omega(\vb{p})}
				\left(
					\int\dd[4]{y}
					g(y^\mu)
					e^{+ip_\mu y^\mu}
				\right)_{p_0=\omega(\vb{p})}
				\\
				&=
				\int\frac{\dd[3]{p}}{(2\pi)^32\omega(\vb{p})}
				f\left(\omega(\vb{p}),\vb{p}\right)^*
				g\left(\omega(\vb{p}),\vb{p}\right)
				\\
				&=
				\braket{1_f}{1_g}
			\end{split}
		\end{equation*}
		where we used \Cref{thm:qkg_comm_pn}, the four-Fourier transform and the definition of the propagator, alternatively, using the commutation relation of the annihilation and creation operator
		\begin{equation*}
			\begin{split}
				\comm{\hat\phi^+[f]}{\hat\phi^-[g]}
				&=
				\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
				f(\vb{p})^*
				\int\frac{\dd[3]{q}}{(2\pi)^3\sqrt{2\omega(\vb{q})}}
				g(\vb{q})
				\comm{\hat{a}(\vb{p})}{\hat{a}^\dagger(\vb{q})}
				\\
				&=
				\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
				f(\vb{p})^*
				\int\frac{\dd[3]{q}}{(2\pi)^3\sqrt{2\omega(\vb{q})}}
				g(\vb{q})
				(2\pi)^3\delta^{(3)}(\vb{q}-\vb{p})
				\\
				&=
				\int\frac{\dd[3]{p}}{(2\pi)^32\omega(\vb{p})}
				f(\vb{p})^*
				g(\vb{p})
				\\
				&=
				\braket{1_f}{1_g}
			\end{split}
		\end{equation*}
		which also equals $\braket{1_f}{1_g}$.
		\item Induction step ($n\to n+1$):
		\begin{equation*}
			\begin{split}
				\comm{\hat\phi^+[f]}{\hat\phi^-[g]^{n+1}}
				&=
				\comm{\hat\phi^+[f]}{\hat\phi^-[g]\hat\phi^-[g]^n}
				\\
				&=
				\hat\phi^-[g]
				\comm{\hat\phi^+[f]}{\hat\phi^-[g]^n}
				+
				\comm{\hat\phi^+[f]}{\hat\phi^-[g]}
				\hat\phi^-[g]^n
				\\
				&=
				\hat\phi^-[g]
				n\braket{1_f}{1_g}
				\hat\phi^-[g]^{n-1}
				+
				\braket{1_f}{1_g}
				\hat\phi^-[g]^n
				\\
				&=
				(n+1)
				\braket{1_f}{1_g}
				\hat\phi^-[g]^n
				.
			\end{split}
		\end{equation*}
	\end{enumerate}
\end{proof}
\qkgsmearedpnladder
\begin{proof}
	Inserting the definitions and using \Cref{thm:qkg_comm_smeared_pn}, we find
	\begin{equation*}
		\begin{split}
			\hat\phi^+[f]
			\ket{n_f}
			&=
			\frac{1}{\sqrt{n!}}
			\hat\phi^+[f]
			\hat\phi^-[f]^n
			\ket{0}
			\\
			&=
			\frac{1}{\sqrt{n!}}
			\comm{\hat\phi^+[f]}{\hat\phi^-[f]^n}
			\ket{0}
			\\
			&=
			\frac{1}{\sqrt{n!}}
			n\braket{1_f}
			\hat\phi^-[f]^{n-1}
			\ket{0}
			\\
			&=
			\sqrt{n}
			\frac{1}{(n-1)!}
			\hat\phi^-[f]^{n-1}
			\ket{0}
			\\
			&=
			\sqrt{n}
			\ket{n-1_f}
		\end{split}
	\end{equation*}
	for the left, and
	\begin{equation*}
		\begin{split}
			\hat\phi^-[f]
			\ket{n_f}
			&=
			\frac{1}{\sqrt{n!}}
			\hat\phi^-[f]
			\hat\phi^-[f]^n
			\ket{0}
			\\
			&=
			\sqrt{n+1}
			\frac{1}{\sqrt{(n+1)!}}
			\hat\phi^-[f]^{n+1}
			\ket{0}
			\\
			&=
			\sqrt{n+1}
			\ket{n+1_f}
		\end{split}
	\end{equation*}
	for the right equation.
\end{proof}

\qkgnumbereigenstate
\begin{proof}
	From \Cref{thm:qkg_comm_smeared_pn}, the left-hand side can be written
	\begin{equation*}
		\comm{\hat\phi^+[f]}{\hat\phi^-[g]^n}
		=
		\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
		f(\vb{p})^*
		\comm{\hat{a}(\vb{p})}{\hat\phi^-[g]^n}
		,
	\end{equation*}
	and the right-hand side can be written
	\begin{equation*}
		\begin{split}
			n
			\braket{1_f}{1_g}
			\hat\phi^-[g]^{n-1}
			&=
			n
			\int\frac{\dd[3]{p}}{(2\pi)^32\omega(\vb{p})}
			f(\vb{p})^*
			g(\vb{p})
			\hat\phi^-[g]^{n-1}
			\\
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
			f(\vb{p})^*
			n
			\frac{g(\vb{p})}{\sqrt{2\omega(\vb{p})}}
			\hat\phi^-[g]^{n-1}
		\end{split}
		.
	\end{equation*}
	Comparing the former and latter, we conclude
	\begin{equation*}
		\comm{\hat{a}(\vb{p})}{\hat\phi^-[g]^n}		
		=
		n
		\frac{g(\vb{p})}{\sqrt{2\omega(\vb{p})}}
		\hat\phi^-[g]^{n-1}
		,
	\end{equation*}
	and we can easily show the eigenvalue equation
	\begin{equation*}
		\begin{split}
			\hat{N}
			\ket{n_f}
			&=
			\int\frac{\dd[3]{p}}{(2\pi)^3}
			\hat{a}^\dagger(\vb{p})
			\hat{a}(\vb{p})
			\frac{1}{\sqrt{n!}}
			\hat\phi^-[f]^n
			\ket{0}
			\\
			&=
			\frac{1}{\sqrt{n!}}
			\int\frac{\dd[3]{p}}{(2\pi)^3}
			\hat{a}^\dagger(\vb{p})
			\comm{\hat{a}(\vb{p})}{\hat\phi^-[f]^n}
			\ket{0}
			\\
			&=
			\frac{1}{\sqrt{n!}}
			\int\frac{\dd[3]{p}}{(2\pi)^3}
			\hat{a}^\dagger(\vb{p})
			n
			\frac{f(\vb{p})}{\sqrt{2\omega(\vb{p})}}
			\hat\phi^-[f]^{n-1}
			\ket{0}
			\\
			&=
			\sqrt{n}
			\int\frac{\dd[3]{p}}{(2\pi)^3\sqrt{2\omega(\vb{p})}}
				f(\vb{p})
			\hat{a}^\dagger(\vb{p})
			\frac{1}{\sqrt{(n-1)!}}
			\hat\phi^-[f]^{n-1}
			\ket{0}
			\\
			&=
			\sqrt{n}
			\hat\phi^-[f]
			\ket{n-1_f}
			=
			n
			\ket{n_f}
		\end{split}
	\end{equation*}
	where we used \Cref{thm:qkg_smeared_pn_ladder} in the last step.
\end{proof}

\qkgnumberinnerproduct
\begin{proof}
	First, we note that
	\begin{equation*}
		\begin{split}
			\braket{n_f}{m_g}
			&=
			\frac{1}{\sqrt{n!m!}}
			\expval{\hat\phi^+[f]^n\hat\phi^-[g]^m}{0}
			\\
			&=
			\frac{1}{\sqrt{nm}}
			\bra{n-1_f}
			\hat\phi^+[f]
			\hat\phi^-[g]
			\ket{m-1_g}
			\\
			&=
			\frac{1}{\sqrt{nm}}
			\bra{n-1_f}
			\comm{\hat\phi^+[f]}{\hat\phi^-[g]}
			\ket{m-1_g}
			-
			\frac{1}{\sqrt{nm}}
			\bra{n-1_f}
			\hat\phi^-[g]
			\hat\phi^+[f]
			\ket{m-1_g}
			\\
			&=
			\frac{1}{\sqrt{nm}}
			\braket{1_f}{1_g}
			\braket{n-1_f}{m-1_g}
			-
			\frac{1}{\sqrt{nm}}
			\bra{n-1_f}
			\hat\phi^-[g]
			\hat\phi^+[f]
			\ket{m-1_g}
		\end{split}
	\end{equation*}
	with the second term being zero unless $m>1$ and $n>1$ because $\bra{0}\hat\phi^-[g]=0$ or $\hat\phi^+[f]\ket{0}=0$.
	Because the relation is iterative, we have $\braket{n_f}{m_g}=0$ unless $n=m$, i.e.,
	\begin{equation*}
		\begin{split}
			\braket{n_f}{m_g}
			&=
			\delta_{nm}
			\frac{1}{n}
			\left\{
				\braket{1_f}{1_g}
				\braket{n-1_f}{n-1_g}
				-
				\bra{n-1_f}
				\hat\phi^-[g]
				\hat\phi^+[f]
				\ket{n-1_g}
			\right\}
			\\
			&=
			\delta_{nm}
			\frac{1}{n}
			\left\{
				\braket{1_f}{1_g}
				\braket{n-1_f}{n-1_g}
				-
				(n-1)
				\bra{n-2_f}
				\ket{n-2_g}
			\right\}
		\end{split}
		.
	\end{equation*}
	where we invoked \Cref{thm:qkg_smeared_pn_ladder}.
\end{proof}

\section{Coherent states}