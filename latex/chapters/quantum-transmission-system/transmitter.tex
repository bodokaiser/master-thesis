\section{Transmitter}

\subsection{Mach-Zehnder modulator}

\begin{figure}[htb]
	\centering
	\includestandalone{figures/pstricks/mzi-symmetric}
	\caption{Free-space setup of a symmetric \gls{mzm}: The input light mode $\hat{a}_1$ enters a first beam splitter BS1 from the left. A vacuum light mode $\hat{a}_2$ enters BS2 from the top. The transformed mode $\hat{a}_1^\prime$ and $\hat{a}_2^\prime$ exit BS1 to the right and the bottom. A first phase shifter and first mirror M1, right to BS1, add a relative phase of $\varphi_1+\pi$ from mode $\hat{a}_1$ to $\hat{a}_1^{\prime\prime}$. Below BS1, a second mirror M2 directs the light to a right second phase shifter, both adding a relative phase of $\varphi_2+\pi$ from mode $\hat{a}_2^\prime$ to $\hat{a}_2^{\prime\prime}$. A second beam splitter BS2 transforms the input modes $\hat{a}_1^{\prime\prime}$ and $\hat{a}_2^{\prime\prime}$ to the output modes $\hat{a}_1^{\prime\prime\prime}$ and $\hat{a}_2^{\prime\prime\prime}$.}
\end{figure}

\begin{equation}
	\begin{split}
		\vb{\hat{a}}^{\prime\prime\prime}
		=
		U_\text{BS2}
		\vb{\hat{a}}^{\prime\prime}
		=
		U_\text{BS2}
		U_\text{PS}
		\vb{\hat{a}}^{\prime}
		=
		U_\text{BS2}
		U_\text{PS}
		U_\text{BS1}
		\vb{\hat{a}}
	\end{split}
\end{equation}
wherein
\begin{align}
	U_\text{BS1}
	&=
	\frac{1}{\sqrt{2}}
	\begin{pmatrix}
		1 & i \\
		i & 1
	\end{pmatrix}
	&
	U_\text{PS}
	&=
	\frac{1}{\sqrt{2}}
	\begin{pmatrix}
		ie^{i\varphi_1} & 0 \\
		0 & ie^{i\varphi_2}
	\end{pmatrix}
	&
	U_\text{BS2}
	&=
	\frac{1}{\sqrt{2}}
	\begin{pmatrix}
		i & 1 \\
		1 & i
	\end{pmatrix}
\end{align}


\begin{equation}
	\begin{pmatrix}
		\hat{a}_1^{\prime\prime\prime} \\
		\hat{a}_2^{\prime\prime\prime}
	\end{pmatrix}
	=
	ie^{i\frac{\varphi_1+\varphi_2}{2}}
	\begin{pmatrix}
		\cos(\frac{\varphi_2-\varphi_1}{2}) & \sin(\frac{\varphi_2-\varphi_1}{2}) \\
		-\sin(\frac{\varphi_2-\varphi_1}{2}) & \cos(\frac{\varphi_2-\varphi_1}{2})
	\end{pmatrix}
	\begin{pmatrix}
		\hat{a}_1 \\
		\hat{a}_2
	\end{pmatrix}
\end{equation}

\begin{table}[htb]
	\centering
	\begin{tabular}{lcc}
		\toprule
		Configuration & Phase relation & Modulation \\
		\midrule
		Push-pull & $\varphi_1=-\varphi_2$ & Amplitude \\
		Push-push & $\varphi_1=+\varphi_2$ & Phase \\
		\bottomrule
	\end{tabular}
	\caption{Configurations of a symmetric \gls{mzm}.}
\end{table}

\begin{equation}
	U_\text{MZM}(\theta)
	=
	\begin{pmatrix}
		\cos(\theta/2) & \sin(\theta/2) \\
		-\sin(\theta/2) & \cos(\theta/2)
	\end{pmatrix}
\end{equation}

\begin{equation}
	\vb{\hat{a}}^\prime
	=
	\hat{U}_\text{MZM}^\dagger(\theta)
	\vb{\hat{a}}
	\hat{U}_\text{MZM}(\theta)
	=
	\exp(-i\theta\hat{L}_y)
	\vb{\hat{a}}
	\exp(+i\theta\hat{L}_y)	
\end{equation}
wherein~\cite[p.~97]{Leonhardt2010}
\begin{equation}
	\hat{L}_y
	=
	\frac{1}{2}
	\vb{\hat{a}}^\dagger
	\sigma_y
	\vb{\hat{a}}
	=
	\frac{i}{2}
	\left(
		\hat{a}_2^\dagger
		\hat{a}_1
		-
		\hat{a}_1^\dagger
		\hat{a}_2
	\right)
	.
\end{equation}

\begin{equation}
	\begin{split}
		\hat{U}_\text{MZM}(\theta)
		\ket{n,0}
		&=
		\frac{1}{\sqrt{n!}}
		\hat{U}_\text{MZM}(\theta)
		(\hat{a}_1^\dagger)^n
		\hat{U}_\text{MZM}^\dagger(\theta)
		\hat{U}_\text{MZM}(\theta)
		\ket{0,0}
		\\
		&=
		\frac{1}{\sqrt{n!}}
		\left[
			\hat{U}_\text{MZM}(\theta)
			\hat{a}^\dagger
			\hat{U}_\text{MZM}^\dagger(\theta)
		\right]^n
		\ket{0,0}
		\\
		&=
		\frac{1}{\sqrt{n!}}
		\left[
			\cos(\theta/2)
			\hat{a}_1^\dagger
			-
			\sin(\theta/2)
			\hat{a}_2^\dagger
		\right]^n
		\ket{0,0}
		\\
		&=
		\frac{1}{\sqrt{n!}}
		\sum_{m=0}^n
		\binom{n}{m}
		\left(
			\cos(\theta/2)
			\hat{a}_1^\dagger
		\right)^{n-m}
		\left(
			-
			\sin(\theta/2)
			\hat{a}_2^\dagger
		\right)^m
		\ket{0,0}
		\\
		&=
		\sum_{m=1}^n
		(-1)^m
		\binom{n}{m}^\frac{1}{2}
		\cos(\theta/2)^{n-m}
		\sin(\theta/2)^m
		\ket{n-m,m}
	\end{split}
\end{equation}
where we used
\begin{equation}
	\begin{split}
		\hat{U}_\text{MZM}(\theta)
		\hat{a}_1^\dagger
		\hat{U}_\text{MZM}^\dagger(\theta)
		&=
		\left[
			\hat{U}_\text{MZM}(\theta)
			\hat{a}_1
			\hat{U}_\text{MZM}^\dagger(\theta)
		\right]^\dagger
		\\
		&=
		\left[
			\hat{U}_\text{MZM}^\dagger(-\theta)
			\hat{a}_1
			\hat{U}_\text{MZM}(-\theta)
		\right]^\dagger
		\\
		&=
		\left[
			\cos(\theta/2)
			\hat{a}_1
			-
			\sin(\theta/2)
			\hat{a}_2
		\right]^\dagger
		\\
		&=
		\cos(\theta/2)
		\hat{a}_1^\dagger
		-
		\sin(\theta/2)
		\hat{a}_2^\dagger
	\end{split}
\end{equation}

\begin{equation}
	\begin{split}
		\hat{U}_\text{MZM}(\theta)
		\ket{\alpha,0}
		&=
		\hat{U}_\text{MZM}(\theta)
		\hat{D}[\alpha]
		\hat{U}_\text{MZM}^\dagger(\theta)
		\hat{U}_\text{MZM}(\theta)
		\ket{0,0}
		\\
		&=
		\exp\left\{
			\alpha
			\hat{U}_\text{MZM}(\theta)
			\hat{a}_1^\dagger
			\hat{U}_\text{MZM}^\dagger(\theta)
			-
			\text{h.c.}
		\right\}
		\ket{0,0}
		\\
		&=
		\exp\left\{
			\alpha
			\cos(\theta/2)\hat{a}_1^\dagger
			-
			\alpha
			\sin(\theta/2)\hat{a}_2^\dagger
			-
			\text{h.c.}
		\right\}
		\ket{0,0}
		\\
		&=
		\ket{\alpha\cos(\theta/2),-\alpha\sin(\theta/2)}
	\end{split}
\end{equation}

\subsection{I/Q modulator}

\begin{figure}[htb]
	\centering
	\includestandalone{figures/pstricks/iqm}
	\caption{\gls{iq}-modulator comprising three \gls{mzm} and connected by an input and output fiber. MZM 1 and MZM 2, are used in push-pull configuration for \gls{am}. MZM 3 is used in push-push configuration for setting the relative phase between the upper and lower branch. Vacuum in- and outputs are indicated by the red dashed fiber.}
\end{figure}

\begin{equation}
	\begin{split}
		\begin{pmatrix}
			\hat{a}_1^{\prime\prime\prime} \\
			\hat{a}_2^{\prime\prime\prime} \\
			\hat{a}_3^{\prime\prime\prime} \\
			\hat{a}_4^{\prime\prime\prime}
		\end{pmatrix}
		&=
		\begin{pmatrix}
			 1 & 0 & 0 & 0 \\
			 0 & \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{BS2}U_\text{PS}$}} & 0 \\
			 0 & & & 0 \\
			 0 & 0 & 0 & 1
		\end{pmatrix}
		\begin{pmatrix}
			\hat{a}_1^{\prime\prime} \\
			\hat{a}_2^{\prime\prime} \\
			\hat{a}_3^{\prime\prime} \\
			\hat{a}_4^{\prime\prime}
		\end{pmatrix}
		\\
		&=
		\begin{pmatrix}
			 1 & 0 & 0 & 0 \\
			 0 & \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{BS2}U_\text{PS}$}} & 0 \\
			 0 & & & 0 \\
			 0 & 0 & 0 & 1
		\end{pmatrix}
		\begin{pmatrix}
			 \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{MZM1}$}} & 0 & 0 \\
			 & & 0 & 0 \\
			 0 & 0 & \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{MZM2}$}} \\
			 0 & 0 & & \\
		\end{pmatrix}
		\begin{pmatrix}
			\hat{a}_1^\prime \\
			\hat{a}_2^\prime \\
			\hat{a}_3^\prime \\
			\hat{a}_4^\prime
		\end{pmatrix}
		\\
		&=
		\begin{pmatrix}
			 1 & 0 & 0 & 0 \\
			 0 & \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{BS2}U_\text{PS}$}} & 0 \\
			 0 & & & 0 \\
			 0 & 0 & 0 & 1
		\end{pmatrix}
		\begin{pmatrix}
			 \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{MZM1}$}} & 0 & 0 \\
			 & & 0 & 0 \\
			 0 & 0 & \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{MZM2}$}} \\
			 0 & 0 & & \\
		\end{pmatrix}
		\begin{pmatrix}
			 1 & 0 & 0 & 0 \\
			 0 & \multicolumn{2}{c}{\multirow{2}{*}{$U_\text{BS1}$}} & 0 \\
			 0 & & & 0 \\
			 0 & 0 & 0 & 1
		\end{pmatrix}
		\begin{pmatrix}
			\hat{a}_1 \\
			\hat{a}_2 \\
			\hat{a}_3 \\
			\hat{a}_4
		\end{pmatrix}
	\end{split}
\end{equation}

\begin{equation}
	\vb{\hat{a}}^{\prime\prime\prime}
	=
	\left[
		\mathbb{I}_1
		\otimes
		U_\text{BS2}
		U_\text{PS}
		\otimes
		\mathbb{I}_1
	\right]
	\left[
		U_\text{MZM1}
		\otimes
		U_\text{MZM2}
	\right]
	\left[
		\mathbb{I}_1
		\otimes
		U_\text{BS1}
		\otimes
		\mathbb{I}_1
	\right]
	\vb{\hat{a}}
\end{equation}