\section{Modulator}

\subsection{Phase (Pockels)}

The Pockels modulator is a phase modulator where an electric field drives the phase of an optical field.
In the optical domain, we can use interference to perform amplitude modulation.
In that sense, the Pockels modulator is the interface between the electrical and optical domains.
For a complete quantum description of the transmitter, understanding the underlying dynamics of the Pockels modulator, particularly the implications of time-dependent modulation, is crucial.

\begin{figure}[htb]
    \centering
    \includegraphics{figures/tikz/pm}
    \caption{Pockels modulator comprising a Pockels cell embedded into a waveguide: The Pockels cell consists of two capacitor plates of length $L$ distanced at $d$. An optical field $\hat{E}_z(t)$ approaches the Pockels cell from the left and exits it to the right as $\hat{E}_z^\prime(t)$. An electric field $\hat{E}_x(t)$ perpendicular to the optical field spans the Pockels cell.}\label{fig:pm}
\end{figure}
\Cref{fig:pm} depicts a Pockels modulator comprising a Pockels cell embedded into a dielectric waveguide.
The Pockels cell is a dielectric plate capacitor with a specific dielectric that mediates the electric and optical field coupling.
The electric field inside the Pockels cell $E_x$ is proportional to the voltage $V$ applied to the Pockels cell.
Assuming the Pockels dielectric to be non-absorbing with \gls{lti} response, the dielectric permittivity tensor can be approximated, see Ref.~\cite{Murti2014} and Ref.~\cite[p.~1070]{Mandel1995},
\begin{equation}
	\varepsilon_{ij}(\omega)
	\approx
	\delta_{ij}
	+
	\chi_{ij}^{(1)}(\omega)
	+
	\chi_{ijk}^{(2)}(\omega)
	E^k(\Omega_0)
\end{equation}
wherein $\chi^{(n)}$ the denotes the $n$th order of the Pockels dielectric's electric susceptibility tensor and $\Omega_0\ll\omega$ is the center frequency of the electric signal.
The refractive index tensor of the Pockels dielectric takes the form
\begin{equation}
	n_{ij}(\omega)
	=
	\sqrt{\varepsilon_{ij}}
	\approx
	n_{ij}^{(0)}
	+
	n_{ijk}^{(1)}(\omega)
	E^k(\Omega_0)
\end{equation}
wherein the refractive index coefficients relate to the dielectric susceptibility tensor via~\cite{Rerat2020}
\begin{align}
	n^{(0)}_{ij}(\omega)
	&=
	\sqrt{1+\chi^{(1)}_{ij}(\omega)}
	&
	n^{(1)}_{ijk}(\omega)
	&=
	\frac{\chi^{(2)}_{ijk}(\omega)
	E^k(\Omega_0)}{2\sqrt{1+\chi^{(1)}_{ij}(\omega)}}
	.
\end{align}
Many elements of the refractive index tensor vanish because of crystal symmetries~\cite[p.~237]{Yariv1984} and we can express the refractive index relevant for the optical field
\begin{equation}
	n_{zz}(\omega,\Omega_0)
	\approx
	n^{(0)}_{zz}(\omega)
	+
	n^{(1)}_{zzx}(\omega)
	E^x(\Omega_0)
\end{equation}
which is linear in the electric \gls{rf} field inside the Pockels cell.
If we now imagine an optical field with frequency $\omega_0$ traveling through a Pockels cell it will accumulate a phase of
\begin{equation}
	\phi(E_x)
	=
	2\pi\frac{n_{zz}(\omega_0,E^x)}{\lambda_0}L
\end{equation} 
and the phase difference compared to a Pockels cell without electric field is proportional to the electric field, i.e.,
\begin{equation}
	\Delta\phi(E_x)
	=
	2\pi\frac{n_{zz}(\omega_0,E^x)-n_{zz}(\omega_0,0)}{\lambda_0}L
	=
	2\pi\frac{n_{zzx}^{(1)}(\omega_0)E^x}{\lambda_0}L
	.
\end{equation}

Up to now, the analysis was entirely classical.
A complete quantum description of the Pockels modulator is given in Ref.~\cite{Horoshko2018}, which we briefly summarize.
The Hamiltonian density of an electromagnetic field in a Pockels dielectric is, see Ref.~\cite[p.~21]{Vogel2006} together with Ref.~\cite[p.~124]{Jackson2007},
\begin{equation}
	H
	=
	\frac{1}{2}
	\int\dd[3]{x}
	\left\{
		\vb{E}(\vb{x})
		\vdot
		\vb{D}(\vb{x})
		+
		\vb{B}(\vb{x})^2
	\right\}
	\label{eq:dielectric_em_hamiltonian}
\end{equation}
wherein $\vb{E}$ is the electric field, $\vb{B}$ is the magnetic field and $\vb{D}$ is the displacement field with components
\begin{equation}
	D_i(\vb{p})
	=
	\varepsilon_{ij}(\vb{p})
	E^j(\vb{p})
	\approx
	E_i(\vb{p})
	+
	\int\frac{\dd[3]{q}}{(2\pi)^3}
	\chi_{ijk}^{(2)}(\vb{q},\vb{p})
	E^j(\vb{p})
	E^k(\vb{q})
\end{equation}
is the electric displacement field where we inserted the nonlinear expansion of the dielectric permittivity tensor and neglected the first-order susceptibility $\chi^{(1)}$.\footnote{The first-order susceptibility can be treated as an additional interaction.}
Inserting the displacement field into the Hamiltonian density, \cref{eq:dielectric_em_hamiltonian}, we recover the free Hamiltonian plus an interaction term
\begin{equation}
	H
	=
	H_0
	+
	H_\text{int}
\end{equation}
where the interaction term is given by
\begin{equation}
	H_\text{int}
	=	
	\frac{1}{2}
	\int\frac{\dd[3]{p}}{(2\pi)^3}
	\int\frac{\dd[3]{q}}{(2\pi)^3}
	\chi_{ijk}^{(2)}(\vb{q},\vb{p})
	E^i(\vb{p})
	E^j(\vb{p})
	E^k(\vb{q})	
\end{equation}
describing any three-point interactions including the linear electro-optical (Pockels) effect but also second harmonic generation, parametric mixing and amplification as well as optical rectification~\cite[p.~14]{Murti2014}.
Adapting the geometry of \Cref{fig:pm} the interaction Hamiltonian becomes
\begin{equation}
	H_\text{int}
	=	
	\frac{1}{2}
	\int\frac{\dd[3]{p}}{(2\pi)^3}
	\int\frac{\dd[3]{q}}{(2\pi)^3}
	\chi_{zzx}^{(2)}(\vb{q},\vb{p})
	E^z(\vb{p}-\vb{q})
	E^z(\vb{p}+\vb{q})
	E^x(\vb{q})	
\end{equation}
describing energy transfer from the electric field to the outgoing optical field.
Comparison of the classic interaction with the quantum nonlinear interactions in Ref.~\cite[p.~33]{QuesadaMejia2015} suggests the quantum interaction Hamiltonian
\begin{equation}
	\hat{H}_\text{int}
	=
	\frac{1}{2}
	\int\frac{\dd[3]{p}}{(2\pi)^3}
	\int\frac{\dd[3]{q}}{(2\pi)^3}
	\Upsilon(\vb{p},\vb{q})
	\hat{a}_x(\vb{q})
	\hat{a}_z^\dagger(\vb{p}-\vb{q})
	\hat{a}_z(\vb{p}+\vb{q})
	+
	\text{h.c.}
\end{equation}
wherein the spatial and response properties of the Pockels cell as well as the phase and momentum matching are encoded into $\Upsilon$.
Assuming only two perpendicular momenta $p_x,p_z$ and taking the electric \gls{rf} as classic, the interaction Hamiltonian further simplifies to
\begin{equation}
	\hat{H}_\text{int}
	=
	\frac{1}{2}
	\int\frac{\dd{p}}{2\pi}
	\int\frac{\dd{q}}{2\pi}
	\Upsilon(p,q)
	\hat{a}_x(q)
	\hat{a}_z^\dagger(p-q)
	\hat{a}_z(p+q)
	+
	\text{h.c.}
	.
\end{equation}
Let $\ket{\beta(t)}$ be the coherent state describing the electric \gls{rf} field, then the interaction Hamiltonian becomes
\begin{equation}
	\hat{H}_\text{int}(t)
	=
	\frac{1}{2}
	\int\frac{\dd{p}}{2\pi}
	\int\frac{\dd{q}}{2\pi}
	\Upsilon(p,q)
	\beta_x(q)^*
	e^{-ipt}
	\hat{a}_z^\dagger(p-q)
	\hat{a}_z(p+q)
	+
	\text{h.c.}
\end{equation}
and when taking the momentum of the electric \gls{rf} field to be small compared to the momentum of the optical field, $p\ll q$, such that
\begin{equation}
	\hat{a}_z^\dagger(p-q)
	\hat{a}_z(p+q)
	\approx
	\hat{a}_z^\dagger(p)
	\hat{a}_z(p)
\end{equation}
we obtain the approximate interaction Hamiltonian
\begin{equation}
	\hat{H}_\text{int}(t)
	\approx
	g(t)
	\int\frac{\dd{q}}{2\pi}
	\hat{a}^\dagger(q)
	\hat{a}(q)
\end{equation}
for which all but the first term of the Magnus expansion vanish\footnote{The operator part is time-independent and therefore the interaction Hamiltonian at different times commutes.} and the exact time-evolution operator turns out to be
\begin{align}
	\hat{U}(t_0,t)
	&=
	\exp\left\{
		-i\varphi(t_0,t)
		\int\frac{\dd{p}}{2\pi}
		\hat{a}^\dagger(p)
		\hat{a}(p)
	\right\}
	&
	\varphi(t_0,t)
	=
	\int_{t_0}^{t}\dd{t^\prime}
	g(t^\prime)
\end{align}
which reduces to the phase-rotation operator proposed in Ref.~\cite[p.~38]{Leonhardt2010} and Ref.~\cite[p.~103]{Vogel2006} in the single-mode limit and time-independent $\varphi$.

We define the action of the phase modulator
\begin{equation}
	\hat{U}_\text{PM}\left[\varphi(t,T)\right]
	=
	\exp\left\{
		-i\varphi(t,T)
		\int\frac{\dd{p}}{2\pi}
		\hat{a}^\dagger(p)
		\hat{a}(p)
	\right\}
\end{equation}
wherein $T$ is the transmit time of the light through the phase modulator.
Assuming a phase modulator of length $L$ and refractive index $n$, the transmit time is approximately
\begin{align}
	T
	&=
	\frac{Ln}{v_\text{gr}}
	&
	v_\text{gr}
	\approx
	\left[
		n
		+
		\omega
		\pdv{n}{\omega}
	\right]_{\omega=\omega_0}^{-1}
\end{align}
where $v_\text{gr}$ is the group velocity in the quasi-monochromatic approximation~\cite[p.~211]{Jackson2007}.
We employ the mean-value theorem for definite integrals
\begin{align}
	\varphi(t,T)
	&=
	\int_{t}^{t+T}\dd{t^\prime}
	g(t^\prime)
	=
	g(\tau)
	T
	&
	\tau\in[t,t+T]
\end{align}
and note that typically the transmit time $T$ is many magnitudes smaller than the modulation time scale $t$, i.e., $T\ll t$, and we can use
\begin{equation}
	\varphi(t,T)
	\approx
	g(t)
	T
	=
	\varphi(t)
	.
\end{equation}

The phase modulator transforms the annihilation operator according to~\cite[p.~38]{Leonhardt2010}
\begin{equation}
	\hat{U}_\text{PM}^\dagger
	\hat{a}(p,t)
	\hat{U}_\text{PM}
	=
	\hat{a}(p,t)
	e^{-i\varphi(t)}
	\label{eq:pm_annihilation}
	.
\end{equation}
The continuous-mode displacement operator transforms according to
\begin{equation}
	\begin{split}
		\hat{U}_\text{PM}\left[\varphi(t)\right]
		\hat{D}\left[\alpha(t)\right]
		\hat{U}_\text{PM}\left[\varphi(t)\right]^\dagger
		&=
		\exp\left\{
			\int_0^\infty\frac{\dd{p}}{2\pi}
			\alpha(p)
			\hat{U}_\text{PM}\left[\varphi(t)\right]
			\hat{a}^\dagger(p,t)
			\hat{U}_\text{PM}\left[\varphi(t)\right]^\dagger
			-
			\text{h.c.}
		\right\}
		\\
		&=
		\exp\left\{
			\int_0^\infty\frac{\dd{p}}{2\pi}
			\alpha(p)
			\left(
				\hat{U}_\text{PM}\left[\varphi(t)\right]
				\hat{a}(p,t)
				\hat{U}_\text{PM}\left[\varphi(t)\right]^\dagger
			\right)^\dagger
			-
			\text{h.c.}
		\right\}
		\\
		&=
		\exp\left\{
			\int_0^\infty\frac{\dd{p}}{2\pi}
			\alpha(p)
			\left(
				\hat{U}_\text{PM}\left[-\varphi(t)\right]^\dagger
				\hat{a}(p,t)
				\hat{U}_\text{PM}\left[-\varphi(t)\right]
			\right)^\dagger
			-
			\text{h.c.}
		\right\}
		\\
		&=
		\exp\left\{
			\int_0^\infty\frac{\dd{p}}{2\pi}
			\alpha(p)
			e^{-i\varphi(t)}
			\hat{a}^\dagger(p,t)
			-
			\text{h.c.}
		\right\}
		\\
		&=
		\hat{D}\left[
			\alpha(t)
			e^{-i\varphi(t)}
		\right]
	\end{split}
\end{equation}
where we used \cref{eq:pm_annihilation} in the fourth line.
The phase-modulated amplitude
\begin{equation}
	\alpha(t)e^{-i\varphi(t)}
\end{equation}
is a multiplication in the time domain.
We expect therefore a convolution in the frequency domain, i.e.,
\begin{equation}
	\int_0^\infty\frac{\dd{p}}{2\pi}
	\alpha(p)
	e^{+ipt}
	e^{-i\varphi(t)}
	\hat{a}^\dagger(p,t)
	=
	\int_0^\infty\frac{\dd{p}}{2\pi}
	\left(u*\alpha\right)(p)
	\hat{a}^\dagger(p,t)
\end{equation}
wherein we used the convolution
\begin{equation}
	\left(u*\alpha\right)(p)
	=
	\int\frac{\dd{p^\prime}}{2\pi}
	u(p^\prime)
	\alpha(p-p^\prime)
	.
\end{equation}
It is difficult to give an explicit form of $u(p)$ for signals $\varphi(t)$ with a continuous frequency spectrum $u(p)$.
However, if we take a simple single-frequency modulation, e.g.,
\begin{equation}
	\varphi(t)
	=
	-
	\varphi_0
	\sin(\omega_0t)
\end{equation}
we can use the Jacobi-Anger expansion to write
\begin{equation}
	e^{i\varphi_0\sin(\omega_0t)}
	=
	\sum_{n\in\mathbb{Z}}
	J_n(\varphi_0)
	e^{in\omega_0 t}
\end{equation}
wherein $J_n$ denotes the $n$th Bessel function of the first kind.
Assuming second order harmonics to be outside the bandwidth of our setup, it is sufficient to only keep the first terms of the Jacobi-Anger expansion
\begin{equation}
	e^{i\varphi_0\sin(\omega_0t)}
	=
	J_{-1}(\varphi_0)
	e^{-i\omega_0t}
	+
	J_0(\varphi_0)
	+
	J_{+1}(\varphi_0)
	e^{+i\omega_0t}
\end{equation}
which corresponds to the convolution kernel
\begin{equation}
	u(p)
	=
	J_{-1}(\varphi_0)
	\delta^{(1)}(p-\omega_0)
	+
	J_0(\varphi_0)
	\delta^{(1)}(p)
	+
	J_{+1}(\varphi_0)
	\delta^{(1)}(p+\omega_0)
	.
\end{equation}

\subsection{Amplitude (Mach-Zehnder)}

The \gls{mzm} arranges two phase modulators to perform amplitude and phase modulation on an optical input field.
Using two electrical-driven phase modulators, the \gls{mzm} performs amplitude and phase modulation on an optical input field.
To begin with, we derive the quantum operator matrix transform from a specific implementation of the \gls{mzm}, the symmetric free-space \gls{mzi}.
Then, we link the quantum operator matrix transform to more general unitary operators.
Finally, we derive the quantum state transform for a coherent input state to the \gls{mzm}.

\begin{figure}[htb]
	\centering
	\includestandalone{figures/pstricks/mzi-symmetric}
	\caption{Free-space setup of a symmetric \gls{mzm}: The input light mode $\hat{a}_1$ enters a first beam splitter BS1 from the left. A vacuum light mode $\hat{a}_2$ enters BS2 from the top. The transformed mode $\hat{a}_1^\prime$ and $\hat{a}_2^\prime$ exit BS1 to the right and the bottom. A first phase shifter and first mirror M1, right to BS1, add a relative phase of $\varphi_1+\pi$ from mode $\hat{a}_1$ to $\hat{a}_1^{\prime\prime}$. Below BS1, a second mirror M2 directs the light to a right second phase shifter, both adding a relative phase of $\varphi_2+\pi$ from mode $\hat{a}_2^\prime$ to $\hat{a}_2^{\prime\prime}$. A second beam splitter BS2 transforms the input modes $\hat{a}_1^{\prime\prime}$ and $\hat{a}_2^{\prime\prime}$ to the output modes $\hat{a}_1^{\prime\prime\prime}$ and $\hat{a}_2^{\prime\prime\prime}$.}\label{fig:mzi_symmetric}
\end{figure}
\Cref{fig:mzi_symmetric} shows a free-space optics setup of a symmetric \gls{mzi} with one signal input; the other input being in the vacuum state.
The most crucial components of the \gls{mzi} are a splitter, a coupler, and two independent phase modulators.
The splitter divides the input light into two branches.
Each branch adds a relative phase shift using an independent phase modulator, i.e., $\phi_1$ and $\phi_2$.
The coupler recombines both branches into two outputs.
For our free-space setup, two cubic beam splitters implement the splitter (BS1) and the coupler (BS2).
For additional beam alignment, our free-space setup utilizes two mirrors (M1 and M2).

Finding the transformation of the annihilation operators at each stage of the \gls{mzi} is sufficient to find the quantum input-output relations.
Idealizing the symmetric \gls{mzi}'s passive components as lossless allows relating the annihilation operators by two-dimensional unitary matrices.
We label the input annihilation operators of the \gls{mzi} $\hat{a}_1,\hat{a}_2$ and the output annihilation operators $\hat{a}_1^{\prime\prime\prime},\hat{a}_2^{\prime\prime\prime}$.
The annihilation operators after splitting and before (after) phase shifting are denoted by two (three) primes, i.e., $\hat{a}_1^{\prime},\hat{a}_2^{\prime}$ and $\hat{a}_1^{\prime\prime},\hat{a}_2^{\prime\prime}$.
Going backwards through the transformations from the output to the input annihilation operators
\begin{equation}
	\vb{\hat{a}}^{\prime\prime\prime}
	=
	U_\text{BS2}
	\hat{\vb{a}}^{\prime\prime}
	=
	U_\text{BS2}
	U_\text{PS}
	\hat{\vb{a}}^{\prime}
	=
	U_\text{BS2}
	U_\text{PS}
	U_\text{BS1}
	\hat{\vb{a}}
	=
	U_\text{MZI}
	\vb{\hat{a}}
\end{equation}
we find the symmetric \gls{mzi}'s unitary matrix transform $U_\text{MZM}$ to be equal to the matrix product of the second beam splitter's, the phase shifts', and the first beam splitter's unitary matrix transform  $U_\text{BS2}U_\text{PS}U_\text{BS1}$.

An ideal cubic beam splitter with a single dielectric layer has the unitary matrix transform~\cite[p.~139]{Gerry2005}
\begin{equation}
	U_\text{BS1}
	=
	\frac{1}{\sqrt{2}}
	\begin{pmatrix}
		1 & i \\
		i & 1
	\end{pmatrix}
\end{equation}
where the off-diagonal elements of $U_\text{BS1}$, $i/\sqrt{2}$, account for the phase-shift due to the reflection at the diagonal of the cubic beam splitter.
The matrix encoding the phase shifts from the phase modulation $\phi_1,\phi_2$ and the reflection at the mirrors M1 and M2, $\pi$ is
\begin{equation}
	U_\text{PS}
	=
	\begin{pmatrix}
		ie^{i\phi_1} & 0 \\
		0 & ie^{i\phi_2}
	\end{pmatrix}
\end{equation}
For the second beam splitter, BS2, we again assume an ideal cubic beam splitter with a single dielectric layer.
The corresponding matrix transform is
\begin{equation}
	U_\text{BS2}
	=
	\frac{1}{\sqrt{2}}
	\begin{pmatrix}
		i & 1 \\
		1 & i
	\end{pmatrix}	
\end{equation}
where we exchanged the rows for consistency with the input labels.

Performing the matrix multiplication and writing the exponentials as trigonometric functions, we find the matrix transform of the symmetric \gls{mzi} to be
\begin{equation}
	U_\text{MZI}
	=
	-
	\begin{pmatrix}
		\cos\left(\frac{\phi_2-\phi_1}{2}\right) & \sin\left(\frac{\phi_2-\phi_1}{2}\right) \\
		-\sin\left(\frac{\phi_2-\phi_1}{2}\right) & \cos\left(\frac{\phi_2-\phi_1}{2}\right)
	\end{pmatrix}
	e^{i\frac{\phi_1+\phi_2}{2}}
	.
\end{equation}
It appears useful to define the common-mode and differential-mode phases
\begin{align}
	\phi_+
	&=
	\phi_2
	+
	\phi_1
	&
	\phi_-
	&=
	\phi_2-\phi_1
\end{align}
for which the matrix transform simplifies to
\begin{equation}
	U_\text{MZI}
	=
	-
	\begin{pmatrix}
		\cos(\phi_-/2) & \sin(\phi_-/2) \\
		-\sin(\phi_-/2) & \cos(\phi_-/2)
	\end{pmatrix}
	e^{i\phi_+/2}
\end{equation}
and we note that the common-mode phase $\phi_+$ adds a global phase shift of $\phi_+/2$ while the differential-mode phase $\phi_-$ changes the splitting ratios at the output.

We conclude that the the action of a static \gls{mzm} on a coherent input state $\ket{\alpha}$ is a amplitude and phase modulation, i.e.,
\begin{equation}
	\ket{\alpha}
	\to
	\ket{\alpha^\prime}
	=
	\hat{P}_1
	\hat{U}_\text{MZM}
	\ket{\alpha,0}
	=
	\ket{\alpha\cos(\Theta/2)e^{i\Lambda/2}}
	\label{eq:mzm_transform}
\end{equation}
where $\Theta$ is the differential- and $\Lambda$ is the common-mode phase applied to the Pockels modulator of the \gls{mzm}.
We have effectively multiplied the amplitude of the initial coherent state with a real value $\cos(\Theta/2)$.

Our result holds true for time-dependent modulation.
From the discussion of the Pockels modulator we know that phase modulation can be written as a convolution in momentum space which is a linear operation and therefore compatible with our derivation of the \gls{mzm}.

\subsection{In-phase and quadrature}