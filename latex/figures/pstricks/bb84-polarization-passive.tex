\documentclass[pstricks]{standalone}

\input{preamble}

\begin{document}
	\begin{pspicture}(0,0)(14.5,6)
		\begin{optexp}
			\psset[optexp]{fiber=none, usefiberstyle}
			\newpsstyle{Fiber}{linecolor=orange}
		  	
			\optsource[compname=Source, sourcewidth=1, abspos=0.1](1,2)(2,2){SPS}
			\optfiberpolarizer[compname=Pol1](2.5,2)(3.5,2){Polarizer}
			\optfiber[compname=Fiber](4.5,2)(5.5,2){Fiber}
			\polcontrol[compname=PolCtrl](6.5,2)(7.5,2){PC}
			\fibercollimator[compname=Colimator, labelangle=180](9,2)(8,2){FC}
			\beamsplitter[compname=BeamSplitter1, labelangle=-90](9,2)(10,2)(10,3){BS}
			\beamsplitter[compname=BeamSplitter2a, labelangle=180, labeloffset=1.4](9,3.75)(10,3.75)(10,4.25){{\begin{tabular}{@{}c@{}}PBS\\(rectilinear)\end{tabular}}}
			\optdetector[compname=Det1a, labelangle=180, labeloffset=1](10,3.75)(10,4.75){SPD}
			\optdetector[compname=Det1b, labelangle=180](10,3.75)(11,3.75)

			\beamsplitter[compname=BeamSplitter2b, labelangle=-90, labeloffset=1](11,2)(12,2)(12,3){{\begin{tabular}{@{}c@{}}PBS\\(diagonal)\end{tabular}}}
			\optdetector[compname=Det2a](12,2)(13,2){SPD}
			\optdetector[compname=Det2b, labelangle=80](12,2)(12,3){SPD}
			
			\drawfiber{Source}{Pol1}{Fiber}{PolCtrl}{Colimator}
			\drawbeam{Colimator}{BeamSplitter1}{BeamSplitter2b}{Det2a}
			\drawbeam{BeamSplitter1}{BeamSplitter2b}{Det2b}
			\drawbeam{Colimator}{BeamSplitter1}{BeamSplitter2a}{Det1a}
			\drawbeam{BeamSplitter1}{BeamSplitter2a}{Det1b}
		\end{optexp}
	\end{pspicture}
\end{document}