\documentclass[tikz]{standalone}

\input{preamble}

\begin{document}
	\begin{tikzpicture}[
		node distance=14pt,
		block/.style={draw, very thick, fill=white, minimum height=28pt, minimum width=58pt},
		superblock/.style={draw, very thick, inner sep=8pt},
	]
		\node (ska) [block] {Secret key};
		\node (ma) [block, right=of ska] {Message};
		\node (pbk) [block, below=of ma] {Public key};
		\node (ch) [block, right=20pt of ma] {Channel};
		\node (mb) [block, right=20pt of ch] {Message};
		\node (skb) [block, right=of mb] {Secret key};
		\node (prk) [block, below=of mb] {Private key};
		
		\node [superblock, label={Alice}, fit=(ska) (pbk)] {};
		\node [superblock, label={Bob}, fit=(skb) (prk)] {};
		
		\draw[-Latex] (ska) -- (ma);
		\draw[-Latex] (pbk) -- (ma);
		\draw[-Latex] (ma) -- (ch);
		\draw[-Latex] (ch) -- (mb);
		\draw[-Latex] (mb) -- (skb);
		\draw[-Latex] (prk) -- (mb);
	\end{tikzpicture}
\end{document}
